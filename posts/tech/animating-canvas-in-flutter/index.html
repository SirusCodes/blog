<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Animating Canvas in Flutter (Draft) | Darshan's Blog</title>
<meta name=keywords content="Flutter,Dart,UI,CustomPainter,Animation"><meta name=description content="CustomPainter is an amazing way to have total control on what you want to paint on screen. Animating these could be tricky but the results are worth it."><meta name=author content="Darshan Rander"><link rel=canonical href=https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://blog.darshanrander.com/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.darshanrander.com/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.darshanrander.com/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.darshanrander.com/favicons/apple-touch-icon.png><link rel=mask-icon href=https://blog.darshanrander.com/favicons/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async defer src=https://analytics.darshanrander.com/script.js data-website-id=288cb966-54e8-44bf-a9d5-dcf9a2aa1d12></script><meta property="og:title" content="Animating Canvas in Flutter (Draft)"><meta property="og:description" content="CustomPainter is an amazing way to have total control on what you want to paint on screen. Animating these could be tricky but the results are worth it."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/"><meta property="og:image" content="https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/images/cover.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-20T00:00:00+05:30"><meta property="article:modified_time" content="2024-04-20T00:00:00+05:30"><meta property="og:site_name" content="Darshan's Blog"><meta property="og:see_also" content="https://blog.darshanrander.com/posts/tech/serverside-dart-2/"><meta property="og:see_also" content="https://blog.darshanrander.com/posts/tech/serverside-dart/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/images/cover.webp"><meta name=twitter:title content="Animating Canvas in Flutter (Draft)"><meta name=twitter:description content="CustomPainter is an amazing way to have total control on what you want to paint on screen. Animating these could be tricky but the results are worth it."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.darshanrander.com/posts/"},{"@type":"ListItem","position":2,"name":"Tech","item":"https://blog.darshanrander.com/posts/tech/"},{"@type":"ListItem","position":3,"name":"Animating Canvas in Flutter (Draft)","item":"https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Animating Canvas in Flutter (Draft)","name":"Animating Canvas in Flutter (Draft)","description":"CustomPainter is an amazing way to have total control on what you want to paint on screen. Animating these could be tricky but the results are worth it.","keywords":["Flutter","Dart","UI","CustomPainter","Animation"],"articleBody":" TL;DR where is the code? - here\nHey everyone! ðŸ‘‹\nSorry for being lazy but Iâ€™m back (at least for now ðŸ˜‰).\nOk back to Flutter and Animations, two of my favourite things in frontend development.\nFull Last year when I was still interning at a company I was asked to build the above animation. It was an interesting but a bit difficult task as the animation had a lot of moving parts and the data inside (amount) will change, hence I cannot use a video or something like that and video would take more space than code. Let me take you through my thought process of building this.\nWhenever I think about building an animation I look at this amazing chart by the Flutter team.\nBy looking at this chart you can see that our animation is basically lines and nodes. So it looks like a drawing and I thought itâ€™s easy to code it (boy I was so wrong ðŸ¥²). Hence I picked CustomPainter.\nBefore I go ahead I would like to mention that you can also create a RenderObject in Flutter if you want any of the element to be clickable or have elements which are complex to build with CustomPainter but easier using existing widgets.\nMoving on to the how I built this animation -\nBuild the static components without any animations. Divide the animation is parts and animate them. Optimize the animation. Create static components When I saw the end state of animation I divided it in 3 sections to focus on.\nRed - Main node Blue - edge lines Yellow - Children nodes Now that we thought about how we are going to split our components, now we can start creating static components. We should also keep in mind that we need to animate these components so just ensure than you use a variables such that it becomes easier to animate it later.\n// Some constants const _roundedRectangleRadius = 25.0; const _padding = 15.0; const Color darkGreen = Color(0xff1B3C37), green = Color(0xff01C36D), text = Color(0xffEBECEC), primary = Color(0xff2A2136); // The CustomPainter (where Flutter devs are artists) class TreeSplitAnimationPainter extends CustomPainter { // Getters for paints Paint get darkGreenPaint =\u003e Paint() ..color = darkGreen ..strokeWidth = 5 ..style = PaintingStyle.stroke ..strokeCap = StrokeCap.round; Paint get greenPaint =\u003e Paint() ..color = green ..strokeWidth = 5 ..style = PaintingStyle.stroke ..strokeCap = StrokeCap.round; // Here we need to write our code which will draw stuff on canvas @override void paint(Canvas canvas, Size size) { // Sizes of outlines and nodes final rootNodeRadius = size.width / 10; final outlineRootNodeRadius = rootNodeRadius + 18; final nodeRadius = size.width / 12; final outlineNodeRadius = nodeRadius + 15; // Painting starts here } } After setting up stuff we can move on to the more interesting part, that is painting on canvas.\nLetâ€™s start with making the nodes as itâ€™s easier and canvas has built in methods for them. We will use Canvas API a lot after this.\nMaking nodes When you look at them you can see a filled cicle and an outlined circle. Ignore the connecting edge lines we will get back to it in next section.\nFor the circles we can use Canvas.drawCircle by giving it the center, radius and style.\ncanvas.drawCircle(center, nodeRadius, circlePaint); Now we can either draw the outline using the same drawCircle method and set it to not fill the colors but we need to animate it hence we will use another method called Canvas.drawArc\ncanvas.drawArc( Rect.fromCircle(center: center, radius: radius), // creates a box in which the circle is formed startAngle, // starting point of arc sweepAngle, // end point of arc false, // `useCenter` = false we don't want to start and end at center paint, // painting instructions ); Donâ€™t get scared this feels easier when you start actually doing it.\nNow you can use these and make a function to build your node!\nvoid _paintNode({ required Canvas canvas, // thing that will paint required Offset center, // obvi required double nodeRadius, // obvi required double outlineNodeRadius, // obvi required double startAngle, // start angle of the arc required Paint circlePaint, // instructions to paint your circle required Paint outlinePaint, // outline painting instructions }) { canvas.drawCircle(center, nodeRadius, circlePaint); _paintOutlineCircle( canvas: canvas, startAngle: startAngle, sweepAngle: math.pi * 2, paint: outlinePaint, radius: outlineNodeRadius, center: center, ); } We will place our nodes later but it will work just perfectly fine. (trust me bro ðŸ™ƒ)\nMaking edge lines Now we are at the most difficult yet interesting section. To create we can use Canvas.drawLine for straight lines or Canvas.drawPath to define path and then ask it to draw, basically have a pen and draw on canvas.\nBy looking at the curves we now that we have to use drawPath method.\ncanvas.drawPath(path, paint); It simply takes path and paint as input but defining path is most complicated.\nBy looking at the lines we can see that it starts at the same point and then splits in middle then moves in either directions and then ends. We can conclude that we need start, and end points and derive middle start and middle end point from them.\nmid = YofStart + (distance between start and end along Y-axis) / 2 midStart = (XofStart, mid) midEnd = (XofEnd, mid) This roughly translates to\n// calculate the point where the line would split final mid = edgeStart.dy + ((edgeEnd.dy - edgeStart.dy) / 2); // point where it start to move left/right final edgeMidStart = Offset(edgeStart.dx, mid); // point where it start to move down again final edgeMidEnd = Offset(edgeEnd.dx, mid); Ahhâ€¦ we can finally create our lines as we have everything we need, now we can jump into Path APIs. Think it as we are drawing with a pen.\nWe need to move our pen to the starting point\npath.moveTo(edgeStart.dx, edgeStart.dy) Then move to the mid start point while drawing a line\npath.lineTo(edgeMidStart.dx, edgeMidStart.dy) Then draw till the mid end point\npath.lineTo(edgeMidEnd.dx, edgeMidEnd.dy) Then finally we can end at end point\npath.lineTo(edgeEnd.dx, edgeEnd.dy) Looks simple enough? You can write it using cascade operator in Dart.\nfinal edgePath = Path() // start ..moveTo(edgeStart.dx, edgeStart.dy) // to mid start ..lineTo(edgeMidStart.dx, edgeMidStart.dy) // to mid end ..lineTo(edgeMidEnd.dx, edgeMidEnd.dy) // to end ..lineTo(edgeEnd.dx, edgeEnd.dy); Now it looks more readable as well and we have something that looks like thisâ€¦\nLooks good but we can do better, lets add those curves.\nWhenever you see a curve you can draw them with a BÃ©zier curve. For this case we are going to use Quadratic BÃ©zier curves.\nQuadratic BÃ©zier curves\nFlutter has Path.quadraticBezierTo which take two co-ordinate points - control and end point. It starts with the last point to the end point controlled by a control point.\nSo the plan it to start a bit before the actual line ends and start before the actual line starts.\nWe can see that we need to -\nStart curve 1 before just before we reach mid start and end it before we reach mid end Start curve 2 before just before we reach mid end and end it just after mid end Our code should look like -\nfinal edgePath = Path() // start ..moveTo(edgeStart.dx, edgeStart.dy) // to mid start ..lineTo(edgeMidStart.dx, edgeMidStart.dy) // early end this // to mid end // *curve 1 here* ..lineTo(edgeMidEnd.dx, edgeMidEnd.dy) // late start and early end this // to end // *curve 2 here* ..lineTo(edgeEnd.dx, edgeEnd.dy); // late start this In flutter quadraticBezierTo takes 4 parameters.\npath.quadraticBezierTo( controlX, controlY, endX, endY, ) I know, I also hate this API.\nfinal edgePath = Path() ..moveTo(edgeStart.dx, edgeStart.dy) ..lineTo( edgeMidStart.dx, edgeMidStart.dy - _roundedRectangleRadius, // early end ) ..quadraticBezierTo( edgeMidStart.dx, edgeMidStart.dy, edgeMidStart.dx + _roundedRectangleRadius, // late start edgeMidStart.dy, ) ..lineTo( edgeMidEnd.dx -_roundedRectangleRadius, // early end edgeMidEnd.dy, ) ..quadraticBezierTo( edgeMidEnd.dx, edgeMidEnd.dy, edgeMidEnd.dx, edgeMidEnd.dy + _roundedRectangleRadius, // late start ) ..lineTo( edgeEnd.dx, edgeEnd.dy, ); This will give you just the right side to get left side you just need to modify a few things.\nfinal edgePath = Path() ... ..quadraticBezierTo( edgeMidStart.dx, edgeMidStart.dy, + edgeMidStart.dx + (isLeft ? -_roundedRectangleRadius : _roundedRectangleRadius), - edgeMidStart.dx + _roundedRectangleRadius, edgeMidStart.dy, ) ..lineTo( + edgeMidEnd.dx - (isLeft ? _roundedRectangleRadius : -_roundedRectangleRadius), - edgeMidEnd.dx -_roundedRectangleRadius, edgeMidEnd.dy, ) ... Finally we can paint it using our drawPath method on Path.\ncanvas.drawPath(edgePath, greenPaint); Creating a method for this would look like -\nvoid _paintEdge({ required Canvas canvas, required Offset edgeStart, required Offset edgeEnd, bool isLeft = false, }) { // calculate the point where the line would split final mid = edgeStart.dy + ((edgeEnd.dy - edgeStart.dy) / 2); // point where it start to move left/right final edgeMidStart = Offset(edgeStart.dx, mid); // point where it start to move down again final edgeMidEnd = Offset(edgeEnd.dx, mid); final edgePath = Path() // Move to the starting point ..moveTo(edgeStart.dx, edgeStart.dy) // Make a straight line to the mid leaving space for curve ..lineTo( edgeMidStart.dx, edgeMidStart.dy - _roundedRectangleRadius, ) // the curve ..quadraticBezierTo( edgeMidStart.dx, edgeMidStart.dy, edgeMidStart.dx + (isLeft ? -_roundedRectangleRadius : _roundedRectangleRadius), edgeMidStart.dy, ) // Line which moves horizontally again leaving space for curve ..lineTo( edgeMidEnd.dx + (isLeft ? _roundedRectangleRadius : -_roundedRectangleRadius), edgeMidEnd.dy, ) // Another curve ..quadraticBezierTo( edgeMidEnd.dx, edgeMidEnd.dy, edgeMidEnd.dx, edgeMidEnd.dy + _roundedRectangleRadius, ) // Stretch line to the end ..lineTo( edgeEnd.dx, edgeEnd.dy, ); // Paint the base dark green color canvas.drawPath(edgePath, darkGreenPaint); } Placing the components For simplicity of code Iâ€™m moving the canvas center from top left to top center by the Canvas.translate\nLetâ€™s take our main node as the reference point to so that things makes sense.\nIt will be a bit below the top center hence the following code -\n@override void paint(Canvas canvas, Size size) { ... // Center canvas horizontally as it becomes easier to make all measurements canvas.translate(size.width / 2, 0); // Point where you want the root node to be at end (top-center) final start = Offset(0, outlineRootNodeRadius); _paintNode( canvas: canvas, center: start, nodeRadius: rootNodeRadius, outlineNodeRadius: outlineRootNodeRadius, startAngle: math.pi / 2, sweepAngle: math.pi * 2, circlePaint: Paint()..color = green, initialOutlinePaint: darkGreenPaint..color = darkGreen, sweepOutlinePaint: greenPaint..color = green, ); ... } @override void paint(Canvas canvas, Size size) { ... // Start point of edge final edgeStart = start + Offset(0, outlineRootNodeRadius); // Note: we will calculate only for right node and for left we will negate it // end point of the edge final edgeEnd = edgeStart + Offset( // adding padding to have distance between 2 children outlineNodeRadius + _padding, // how much space child will need from the bottom size.height - (outlineNodeRadius * 2) - edgeStart.dy - _padding, ); // position of child node final childNode = edgeEnd + Offset(0, outlineNodeRadius); // Right edge _paintEdge( canvas: canvas, edgeStart: edgeStart, edgeEnd: edgeEnd, ); _paintNode( canvas: canvas, center: childNode, nodeRadius: nodeRadius, outlineNodeRadius: outlineNodeRadius, startAngle: -math.pi / 2, sweepAngle: math.pi * 2, circlePaint: Paint()..color = primary, initialOutlinePaint: darkGreenPaint, sweepOutlinePaint: greenPaint, ); // Left edge _paintEdge( canvas: canvas, edgeStart: edgeStart, edgeEnd: edgeEnd.scale(-1, 1), // negate on x-axis isLeft: true, ); _paintNode( canvas: canvas, center: childNode.scale(-1, 1), // negate on x-axis nodeRadius: nodeRadius, outlineNodeRadius: outlineNodeRadius, startAngle: -math.pi / 2, sweepAngle: math.pi * 2, circlePaint: Paint()..color = primary, initialOutlinePaint: darkGreenPaint, sweepOutlinePaint: greenPaint, ); } Finally after sooooo much efforts we are able to create a static painting on our canvas.\nNow we can move to the more difficult part that is animating it.\nDivide the animation is parts and animate them While having working on animating the components we need to look at the bigger picture and think in terms of when the animation starts and when it ends and how it is connected to each other.\nBefore we write code itâ€™s always better to plan how we are going to do it, as it will make it a lot easier for you to code it and more importantly understand it.\nYou can divide when the direction of motion, color, or focus (Object which is animating) of animation changes.\nTrust your gut feeling.\nTracking Main nodeâ€™s motion Full We just need move the center of our main node from center of the screen to the main position where it should be\n@override void paint(Canvas canvas, Size size) { ... // Point where you want the root node to be at end (top-center) final start = Offset(0, outlineRootNodeRadius); // Get center of the screen final center = Offset(0, size.height / 2); // Paint main node _paintNode( canvas: canvas, center: lerpOffset(center, start, moveRootToTop.value), nodeRadius: rootNodeRadius, ... ); ... } lerpOffset will move our node from center to start while we can control the percent of movement with moveRootToTop.value\nedge lines appear Full The edge lines appear and shifts attention of the user from main head to it. Itâ€™s very easy, just change opacity from 0 to 1.\nFor this we will just update our darkGreenPaint getter to have color with an opacity to it.\nPaint get darkGreenPaint =\u003e Paint() ..color = darkGreen.withOpacity(fadeInEdge.value) ..strokeWidth = 5 ..style = PaintingStyle.stroke ..strokeCap = StrokeCap.round; We can control the fade in of this with fadeInEdge.value.\nGreen color flows from main node to edge lines Full We can see that the color from the outline of main node decreases, to make this we can use sweepAngle and decrease it. Before that to make it easier we can have green color outline stacked on dark green color outline by updating our _paintNode method.\nvoid _paintNode({ ... required double startAngle, required double sweepAngle, required Paint circlePaint, required Paint initialOutlinePaint, required Paint sweepOutlinePaint, }) { ... _paintOutlineCircle( ... paint: initialOutlinePaint, ); _paintOutlineCircle( canvas: canvas, startAngle: startAngle, sweepAngle: sweepAngle, paint: sweepOutlinePaint, radius: outlineNodeRadius, center: center, ); } Things changed here are that we have sweep angle and 2 paint for outline - initial and sweep\nFor main node the sweep angle decreases, (i.e. 2Ï€ to 0) by changing the calling function\n_paintNode( ... startAngle: math.pi / 2, sweepAngle: lerpDouble(math.pi * 2, 0, edgeFill.value)!, initialOutlinePaint: darkGreenPaint..color = darkGreen, sweepOutlinePaint: greenPaint..color = green, ); lerpDouble(math.pi * 2, 0, edgeFill.value) will move from 2Ï€ to 0 controlled by edgeFill.value.\nWhile itâ€™s decreasing we also need to fill the edge lines. Animating lines and curves but I found a neat trick to do this on stackoverflow by andras.\nOver here they divided the given path into segments and add it to the path till the specified percentage is reached.\nWe can use createAnimatedPath function to get the desired animation. Again we will stack it on the dark green color.\nvoid _paintEdge({ ... }) { ... // Paint the base dark green color canvas.drawPath(edgePath, darkGreenPaint); if (edgeFill.value != 0) // Paint the green color which comes in 3rd section canvas.drawPath( createAnimatedPath(edgePath, edgeFill.value), greenPaint, ); } edgeFill.value here increases the value from 0 to 1 increasing the color filled in edge lines.\nNoticed that the whole animation is controlled by edgeFill.value, it decreased the value for main node outline while increased the color in edge lines.\nGreen color flows from edge lines to children Full This is exact opposite of what we did in previous step. The edge lines decrease and children node outline increases.\nLike the question â€˜Is the glass half empty or half full?â€™ we can say that the edge lines are filling with dark green color instead of draining dark green color as itâ€™s a bit difficult to handle.\nWe will stack filling dark green color lines on the existing stack\nvoid _paintEdge({ ... }) { ... if (childrenFill.value != 0) // Paint it again dark green for final section canvas.drawPath( createAnimatedPath(edgePath, lerpDouble(0, 1, childrenFill.value)!), darkGreenPaint, ); } This is handled by childrenFill.value and we will use the same thing for all the animations in this section.\nTo fill the outline of children nodes we will increase the sweepAngle from 0 to 2Ï€ and fade in the circles at the same time.\n_paintNode( ... startAngle: -math.pi / 2, sweepAngle: lerpDouble(0, 2 * math.pi, childrenFill.value)!, circlePaint: Paint()..color = primary.withOpacity(childrenFill.value), initialOutlinePaint: darkGreenPaint, sweepOutlinePaint: greenPaint, ); Orchestrating these animations You might think what are these moveRootToTop, fadeInEdge, edgeFill, and childrenFill? These are technically variables with Animation type, I use them to orchestrate the animation. AnimationController while controls the animation, we can attach the controller to multiple Animation to have finer control. Using CurvedAnimation to have different Curves and Interval to define the interval in which the Animation should start and end, for example - start at 20% and end at 60% of animation duration will be written as Interval(0.2, 0.6). Finally all this will be packed in a Tween where you will define the start and end value of the animation.\nThis will look like -\nanimation = Tween\u003cdouble\u003e(begin: 0, end: 1).animate( CurvedAnimation( parent: animationController, curve: const Interval(0.1, 0.2, curve: Curves.easeInOut), ), ); I read it from inside out - start the animation at 10% and end it at 20% following ease-in-out curve, it will be controlled by the animationController and the value will move from 0 to 1.\nComing back to our animation -\nYou can define it as late variable and then assign it in the contructor of the class.\nlate final Animation\u003cdouble\u003e edgeFill, fadeInEdge, fadeInChildren, moveRootToTop; TreeSplitAnimationPainter({ required AnimationController animationController, }) { // Tween that moved the root node up as soon as animation starts moveRootToTop = Tween\u003cdouble\u003e(begin: 0, end: 1).animate( CurvedAnimation( parent: animationController, curve: const Interval(0, 0.2, curve: Curves.easeInOut), ), ); // Shows the dark green colored edges fadeInEdge = Tween\u003cdouble\u003e(begin: 0, end: 1).animate( CurvedAnimation( parent: animationController, curve: const Interval(0.2, 0.3, curve: Curves.easeInOut), ), ); // Fills the dark green colored edges with green color // and removes green from the outline of root node edgeFill = Tween\u003cdouble\u003e(begin: 0, end: 1).animate( CurvedAnimation( parent: animationController, curve: const Interval(0.3, 0.7, curve: Curves.easeInOut), ), ); // Show the children nodes inside the outline fadeInChildren = Tween\u003cdouble\u003e(begin: 0, end: 1).animate( CurvedAnimation( parent: animationController, curve: const Interval(0.7, 1, curve: Curves.easeInOut), ), ); } Finally we can use this custom painter in our app!! But before that I would like to suggest you some of the optimizations for the app.\nOptimize the animation Optimizing the canvas animations is not that difficult you just need to be away what are you doing and anything you do may or may not have impact on memory, so beware do it only if you need it.\nPremature optimization is the root of evil.\nPass your AnimationController to the repaint property in the CustomPainter constructor.\nclass TreeSplitAnimationPainter extends CustomPainter { TreeSplitAnimationPainter({ required AnimationController animationController, }) : super(repaint: animationController); // Pass the controller here ... } Never do set shouldRepaint to true\nclass Sky extends CustomPainter { Sky(this.color); final Color color; @override void paint(canvas, size) { ... } // Don't do this @override bool shouldRepaint(Sky oldDelegate) =\u003e true; } Always specify shouldRepaint to react to changes.\nclass Sky extends CustomPainter { Sky(this.color); final Color color; @override void paint(canvas, size) { ... } // Do do this @override bool shouldRepaint(Sky oldDelegate) =\u003e color != oldDelegate.color; } Set isComplex to true in CustomPaint widget\nCustomPaint( ... isComplex: true, ), This will cache images of the CustomPaint.\nIf an animation causes random rebuilds of your screen you can use RepaintBoundary widget. It separates itâ€™s children from the parent while repainting.\nRepaintBoundary( child: ... ) Code and Thanks note You can go to this site to play around with the code and test the code yourself.\nThanks a lot for reading this long blog! I really enjoy working with animations and CustomPainter in flutter, do connect with me over my socials if you want to have a chat or need any help.\n","wordCount":"3225","inLanguage":"en","image":"https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/images/cover.webp","datePublished":"2024-04-20T00:00:00+05:30","dateModified":"2024-04-20T00:00:00+05:30","author":{"@type":"Person","name":"Darshan Rander"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/"},"publisher":{"@type":"Organization","name":"Darshan's Blog","logo":{"@type":"ImageObject","url":"https://blog.darshanrander.com/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.darshanrander.com/ accesskey=h title="Darshan's Blog (Alt + H)">Darshan's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://blog.darshanrander.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.darshanrander.com/series/ title=Series><span>Series</span></a></li><li><a href=https://blog.darshanrander.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://darshanrander.com title=darshanrander.com><span>darshanrander.com</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.darshanrander.com/>Home</a>&nbsp;Â»&nbsp;<a href=https://blog.darshanrander.com/posts/>Posts</a>&nbsp;Â»&nbsp;<a href=https://blog.darshanrander.com/posts/tech/>Tech</a></div><h1 class=post-title>Animating Canvas in Flutter (Draft)</h1><div class=post-meta>&lt;span title='2024-04-20 00:00:00 +0530 +0530'>April 20, 2024&lt;/span>&amp;nbsp;Â·&amp;nbsp;16 min&amp;nbsp;Â·&amp;nbsp;3225 words&amp;nbsp;Â·&amp;nbsp;Darshan Rander&nbsp;|&nbsp;<a href=https://github.com/SirusCodes/blog/tree/main/content/posts/tech/animating-canvas-in-flutter/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/images/cover.webp alt="CustomPainter Animations in Flutter cover photo"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#create-static-components aria-label="Create static components">Create static components</a><ul><li><a href=#making-nodes aria-label="Making nodes">Making nodes</a></li><li><a href=#making-edge-lines aria-label="Making edge lines">Making edge lines</a></li><li><a href=#placing-the-components aria-label="Placing the components">Placing the components</a></li></ul></li><li><a href=#divide-the-animation-is-parts-and-animate-them aria-label="Divide the animation is parts and animate them">Divide the animation is parts and animate them</a><ul><li><a href=#tracking-main-nodes-motion aria-label="Tracking Main node&amp;rsquo;s motion">Tracking Main node&rsquo;s motion</a></li><li><a href=#edge-lines-appear aria-label="edge lines appear">edge lines appear</a></li><li><a href=#green-color-flows-from-main-node-to-edge-lines aria-label="Green color flows from main node to edge lines">Green color flows from main node to edge lines</a></li><li><a href=#green-color-flows-from-edge-lines-to-children aria-label="Green color flows from edge lines to children">Green color flows from edge lines to children</a></li><li><a href=#orchestrating-these-animations aria-label="Orchestrating these animations">Orchestrating these animations</a></li></ul></li><li><a href=#optimize-the-animation aria-label="Optimize the animation">Optimize the animation</a></li><li><a href=#code-and-thanks-note aria-label="Code and Thanks note">Code and Thanks note</a></li></ul></div></details></div><div class=post-content><blockquote><p>TL;DR where is the code? - <a href="https://zapp.run/edit/tree-split-animation-zlt6069tlt70?entry=lib/main.dart&amp;file=lib/tree_split_animation.dart">here</a></p></blockquote><p>Hey everyone! ðŸ‘‹</p><p>Sorry for being lazy but I&rsquo;m back (at least for now ðŸ˜‰).</p><p>Ok back to Flutter and Animations, two of my favourite things in frontend development.</p><center><video width=50% autoplay loop>
<source src=./videos/animation-full.mp4 type=video/mp4>Full</video></center><p>Last year when I was still interning at a company I was asked to build the above animation. It was an interesting but a bit difficult task as the animation had a lot of moving parts and the data inside (amount) will change, hence I cannot use a video or something like that and video would take more space than code. Let me take you through my thought process of building this.</p><p>Whenever I think about building an animation I look at this amazing chart by the Flutter team.</p><p><a href=https://docs.flutter.dev/ui/animations><img loading=lazy src=https://docs.flutter.dev/assets/images/docs/ui/animations/animation-decision-tree.png alt="Which is better approach for an animation in Flutter"></a></p><p>By looking at this chart you can see that our animation is basically lines and nodes. So it looks like a drawing and I thought it&rsquo;s easy to code it (boy I was so wrong ðŸ¥²). Hence I picked CustomPainter.</p><p>Before I go ahead I would like to mention that you can also create a <a href=https://api.flutter.dev/flutter/rendering/RenderObject-class.html>RenderObject</a> in Flutter if you want any of the element to be clickable or have elements which are complex to build with CustomPainter but easier using existing widgets.</p><p>Moving on to the how I built this animation -</p><ol><li>Build the static components without any animations.</li><li>Divide the animation is parts and animate them.</li><li>Optimize the animation.</li></ol><h3 id=create-static-components>Create static components<a hidden class=anchor aria-hidden=true href=#create-static-components>#</a></h3><p>When I saw the end state of animation I divided it in 3 sections to focus on.</p><figure class=align-center><img loading=lazy src=./images/animation-end-sectioned.jpg#center width=50%></figure><ol><li>Red - Main node</li><li>Blue - edge lines</li><li>Yellow - Children nodes</li></ol><p>Now that we thought about how we are going to split our components, now we can start creating static components. We should also keep in mind that we need to animate these components so just ensure than you use a variables such that it becomes easier to animate it later.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=c1>// Some constants
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=n>_roundedRectangleRadius</span> <span class=o>=</span> <span class=m>25.0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>const</span> <span class=n>_padding</span> <span class=o>=</span> <span class=m>15.0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>const</span> <span class=n>Color</span> <span class=n>darkGreen</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=mh>0xff1B3C37</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>green</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=mh>0xff01C36D</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=mh>0xffEBECEC</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>primary</span> <span class=o>=</span> <span class=n>Color</span><span class=p>(</span><span class=mh>0xff2A2136</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// The CustomPainter (where Flutter devs are artists)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>TreeSplitAnimationPainter</span> <span class=kd>extends</span> <span class=n>CustomPainter</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Getters for paints
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>Paint</span> <span class=kd>get</span> <span class=n>darkGreenPaint</span> <span class=o>=&gt;</span> <span class=n>Paint</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>..</span><span class=n>color</span> <span class=o>=</span> <span class=n>darkGreen</span>
</span></span><span class=line><span class=cl>    <span class=p>..</span><span class=n>strokeWidth</span> <span class=o>=</span> <span class=m>5</span>
</span></span><span class=line><span class=cl>    <span class=p>..</span><span class=n>style</span> <span class=o>=</span> <span class=n>PaintingStyle</span><span class=p>.</span><span class=n>stroke</span>
</span></span><span class=line><span class=cl>    <span class=p>..</span><span class=n>strokeCap</span> <span class=o>=</span> <span class=n>StrokeCap</span><span class=p>.</span><span class=n>round</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>Paint</span> <span class=kd>get</span> <span class=n>greenPaint</span> <span class=o>=&gt;</span> <span class=n>Paint</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>..</span><span class=n>color</span> <span class=o>=</span> <span class=n>green</span>
</span></span><span class=line><span class=cl>    <span class=p>..</span><span class=n>strokeWidth</span> <span class=o>=</span> <span class=m>5</span>
</span></span><span class=line><span class=cl>    <span class=p>..</span><span class=n>style</span> <span class=o>=</span> <span class=n>PaintingStyle</span><span class=p>.</span><span class=n>stroke</span>
</span></span><span class=line><span class=cl>    <span class=p>..</span><span class=n>strokeCap</span> <span class=o>=</span> <span class=n>StrokeCap</span><span class=p>.</span><span class=n>round</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Here we need to write our code which will draw stuff on canvas
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=kt>void</span> <span class=n>paint</span><span class=p>(</span><span class=n>Canvas</span> <span class=n>canvas</span><span class=p>,</span> <span class=n>Size</span> <span class=n>size</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Sizes of outlines and nodes
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>final</span> <span class=n>rootNodeRadius</span> <span class=o>=</span> <span class=n>size</span><span class=p>.</span><span class=n>width</span> <span class=o>/</span> <span class=m>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>outlineRootNodeRadius</span> <span class=o>=</span> <span class=n>rootNodeRadius</span> <span class=o>+</span> <span class=m>18</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>nodeRadius</span> <span class=o>=</span> <span class=n>size</span><span class=p>.</span><span class=n>width</span> <span class=o>/</span> <span class=m>12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>outlineNodeRadius</span> <span class=o>=</span> <span class=n>nodeRadius</span> <span class=o>+</span> <span class=m>15</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Painting starts here
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>After setting up stuff we can move on to the more interesting part, that is painting on canvas.</p><p>Let&rsquo;s start with making the nodes as it&rsquo;s easier and canvas has built in methods for them. We will use <a href=https://api.flutter.dev/flutter/dart-ui/Canvas-class.html>Canvas API</a> a lot after this.</p><h4 id=making-nodes>Making nodes<a hidden class=anchor aria-hidden=true href=#making-nodes>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><img loading=lazy src=./images/animation-end-main-node.jpg alt="Main node"></td><td><img loading=lazy src=./images/animation-end-children-node.jpg alt="Children nodes"></td></tr></tbody></table><p>When you look at them you can see a filled cicle and an outlined circle. Ignore the connecting edge lines we will get back to it in next section.</p><p>For the circles we can use <a href=https://api.flutter.dev/flutter/dart-ui/Canvas/drawCircle.html>Canvas.drawCircle</a> by giving it the center, radius and style.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>canvas</span><span class=p>.</span><span class=n>drawCircle</span><span class=p>(</span><span class=n>center</span><span class=p>,</span> <span class=n>nodeRadius</span><span class=p>,</span> <span class=n>circlePaint</span><span class=p>);</span>
</span></span></code></pre></div><p>Now we can either draw the outline using the same <code>drawCircle</code> method and set it to not fill the colors but we need to animate it hence we will use another method called <a href=https://api.flutter.dev/flutter/dart-ui/Canvas/drawArc.html>Canvas.drawArc</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>canvas</span><span class=p>.</span><span class=n>drawArc</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>Rect</span><span class=p>.</span><span class=n>fromCircle</span><span class=p>(</span><span class=nl>center:</span> <span class=n>center</span><span class=p>,</span> <span class=nl>radius:</span> <span class=n>radius</span><span class=p>),</span> <span class=c1>// creates a box in which the circle is formed
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>startAngle</span><span class=p>,</span>         <span class=c1>// starting point of arc
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>sweepAngle</span><span class=p>,</span>         <span class=c1>// end point of arc
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kc>false</span><span class=p>,</span>              <span class=c1>// `useCenter` = false we don&#39;t want to start and end at center
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>paint</span><span class=p>,</span>              <span class=c1>// painting instructions
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>);</span>
</span></span></code></pre></div><p>Don&rsquo;t get scared this feels easier when you start actually doing it.</p><p>Now you can use these and make a function to build your node!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kt>void</span> <span class=n>_paintNode</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=n>Canvas</span> <span class=n>canvas</span><span class=p>,</span>             <span class=c1>// thing that will paint
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>required</span> <span class=n>Offset</span> <span class=n>center</span><span class=p>,</span>             <span class=c1>// obvi
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>required</span> <span class=kt>double</span> <span class=n>nodeRadius</span><span class=p>,</span>         <span class=c1>// obvi
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>required</span> <span class=kt>double</span> <span class=n>outlineNodeRadius</span><span class=p>,</span>  <span class=c1>// obvi
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>required</span> <span class=kt>double</span> <span class=n>startAngle</span><span class=p>,</span>         <span class=c1>// start angle of the arc
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>required</span> <span class=n>Paint</span> <span class=n>circlePaint</span><span class=p>,</span>         <span class=c1>// instructions to paint your circle
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>required</span> <span class=n>Paint</span> <span class=n>outlinePaint</span><span class=p>,</span>        <span class=c1>// outline painting instructions
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>canvas</span><span class=p>.</span><span class=n>drawCircle</span><span class=p>(</span><span class=n>center</span><span class=p>,</span> <span class=n>nodeRadius</span><span class=p>,</span> <span class=n>circlePaint</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>_paintOutlineCircle</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>canvas:</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>startAngle:</span> <span class=n>startAngle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>sweepAngle:</span> <span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>*</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>paint:</span> <span class=n>outlinePaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>radius:</span> <span class=n>outlineNodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>center:</span> <span class=n>center</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>We will place our nodes later but it will work just perfectly fine. (trust me bro ðŸ™ƒ)</p><h4 id=making-edge-lines>Making edge lines<a hidden class=anchor aria-hidden=true href=#making-edge-lines>#</a></h4><p><img loading=lazy src=./images/animation-end-edges.jpg alt=Edges></p><p>Now we are at the most difficult yet interesting section. To create we can use <a href=https://api.flutter.dev/flutter/dart-ui/Canvas/drawLine.html>Canvas.drawLine</a> for straight lines or <a href=https://api.flutter.dev/flutter/dart-ui/Canvas/drawPath.html>Canvas.drawPath</a> to define path and then ask it to draw, basically have a pen and draw on canvas.</p><p>By looking at the curves we now that we have to use <code>drawPath</code> method.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>canvas</span><span class=p>.</span><span class=n>drawPath</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>paint</span><span class=p>);</span>
</span></span></code></pre></div><p>It simply takes <code>path</code> and <code>paint</code> as input but defining <code>path</code> is most complicated.</p><p>By looking at the lines we can see that it starts at the same point and then splits in middle then moves in either directions and then ends. We can conclude that we need start, and end points and derive middle start and middle end point from them.</p><pre tabindex=0><code>mid       =   YofStart + (distance between start and end along Y-axis) / 2
midStart  =   (XofStart, mid)
midEnd    =   (XofEnd, mid)
</code></pre><p>This roughly translates to</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=c1>// calculate the point where the line would split
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>final</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span> <span class=o>+</span> <span class=p>((</span><span class=n>edgeEnd</span><span class=p>.</span><span class=n>dy</span> <span class=o>-</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span> <span class=o>/</span> <span class=m>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// point where it start to move left/right
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>final</span> <span class=n>edgeMidStart</span> <span class=o>=</span> <span class=n>Offset</span><span class=p>(</span><span class=n>edgeStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>mid</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// point where it start to move down again
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>final</span> <span class=n>edgeMidEnd</span> <span class=o>=</span> <span class=n>Offset</span><span class=p>(</span><span class=n>edgeEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>mid</span><span class=p>);</span>
</span></span></code></pre></div><p>Ahh&mldr; we can finally create our lines as we have everything we need, now we can jump into <a href=https://api.flutter.dev/flutter/dart-ui/Path-class.html>Path APIs</a>. Think it as we are drawing with a pen.</p><p>We need to move our pen to the starting point</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>path</span><span class=p>.</span><span class=n>moveTo</span><span class=p>(</span><span class=n>edgeStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span></code></pre></div><p>Then move to the mid start point while drawing a line</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>path</span><span class=p>.</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span></code></pre></div><p>Then draw till the mid end point</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>path</span><span class=p>.</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span></code></pre></div><p>Then finally we can end at end point</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>path</span><span class=p>.</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span></code></pre></div><p>Looks simple enough? You can write it using <a href=https://dart.dev/language/operators#cascade-notation>cascade operator</a> in Dart.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>final</span> <span class=n>edgePath</span> <span class=o>=</span> <span class=n>Path</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>// start
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>..</span><span class=n>moveTo</span><span class=p>(</span><span class=n>edgeStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// to mid start
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// to mid end
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// to end
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>);</span>
</span></span></code></pre></div><p>Now it looks more readable as well and we have something that looks like this&mldr;</p><p><img loading=lazy src=./images/animation-edge-not-curved.jpg alt="Edge lines without curves"></p><p>Looks good but we can do better, lets add those curves.</p><p>Whenever you see a curve you can draw them with a <a href=https://en.wikipedia.org/wiki/B%C3%A9zier_curve>BÃ©zier curve</a>. For this case we are going to use <a href="https://en.wikipedia.org/wiki/B%C3%A9zier_curve#:~:text=Quadratic%20B%C3%A9zier%20curves%5Bedit%5D">Quadratic BÃ©zier curves</a>.</p><figure class=align-center><img loading=lazy src=./images/quadratic-curve.png#center alt="Quadratic BÃ©zier curves" width=20%><figcaption><p>Quadratic BÃ©zier curves</p></figcaption></figure><p>Flutter has <a href=https://api.flutter.dev/flutter/dart-ui/Path/quadraticBezierTo.html>Path.quadraticBezierTo</a> which take two co-ordinate points - control and end point. It starts with the last point to the end point controlled by a control point.</p><p>So the plan it to start a bit before the actual line ends and start before the actual line starts.</p><p><img loading=lazy src=./images/animation-edge-not-curved-curves-points.jpg alt="Edge lines with point of curve dots"></p><p>We can see that we need to -</p><ul><li>Start curve 1 before just before we reach <em>mid start</em> and end it before we reach <em>mid end</em></li><li>Start curve 2 before just before we reach <em>mid end</em> and end it just after <em>mid end</em></li></ul><p>Our code should look like -</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>final</span> <span class=n>edgePath</span> <span class=o>=</span> <span class=n>Path</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>// start
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>..</span><span class=n>moveTo</span><span class=p>(</span><span class=n>edgeStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// to mid start
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>  <span class=c1>// early end this
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// to mid end
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// *curve 1 here*
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>      <span class=c1>// late start and early end this
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// to end
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// *curve 2 here*
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span><span class=n>edgeEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>);</span>           <span class=c1>// late start this
</span></span></span></code></pre></div><p>In flutter <code>quadraticBezierTo</code> takes 4 parameters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>path</span><span class=p>.</span><span class=n>quadraticBezierTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>controlX</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>controlY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>endX</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>endY</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><p>I know, I also hate this API.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>final</span> <span class=n>edgePath</span> <span class=o>=</span> <span class=n>Path</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>moveTo</span><span class=p>(</span><span class=n>edgeStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span> <span class=o>-</span> <span class=n>_roundedRectangleRadius</span><span class=p>,</span>  <span class=c1>// early end
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>quadraticBezierTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span> <span class=o>+</span> <span class=n>_roundedRectangleRadius</span><span class=p>,</span>  <span class=c1>// late start
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span> <span class=o>-</span><span class=n>_roundedRectangleRadius</span><span class=p>,</span>     <span class=c1>// early end
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>quadraticBezierTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span> <span class=o>+</span> <span class=n>_roundedRectangleRadius</span><span class=p>,</span>    <span class=c1>// late start
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span></code></pre></div><p>This will give you just the right side to get left side you just need to modify a few things.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>final</span> <span class=n>edgePath</span> <span class=o>=</span> <span class=n>Path</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>quadraticBezierTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=o>+</span>   <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span> <span class=o>+</span> <span class=p>(</span><span class=n>isLeft</span> <span class=o>?</span> <span class=o>-</span><span class=n>_roundedRectangleRadius</span> <span class=o>:</span> <span class=n>_roundedRectangleRadius</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=o>-</span>   <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span> <span class=o>+</span> <span class=n>_roundedRectangleRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl><span class=o>+</span>   <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span> <span class=o>-</span> <span class=p>(</span><span class=n>isLeft</span> <span class=o>?</span> <span class=n>_roundedRectangleRadius</span> <span class=o>:</span> <span class=o>-</span><span class=n>_roundedRectangleRadius</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=o>-</span>   <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span> <span class=o>-</span><span class=n>_roundedRectangleRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span></code></pre></div><p>Finally we can paint it using our <code>drawPath</code> method on <code>Path</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>canvas</span><span class=p>.</span><span class=n>drawPath</span><span class=p>(</span><span class=n>edgePath</span><span class=p>,</span> <span class=n>greenPaint</span><span class=p>);</span>
</span></span></code></pre></div><p>Creating a method for this would look like -</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kt>void</span> <span class=n>_paintEdge</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=n>Canvas</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=n>Offset</span> <span class=n>edgeStart</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=n>Offset</span> <span class=n>edgeEnd</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kt>bool</span> <span class=n>isLeft</span> <span class=o>=</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// calculate the point where the line would split
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span> <span class=o>+</span> <span class=p>((</span><span class=n>edgeEnd</span><span class=p>.</span><span class=n>dy</span> <span class=o>-</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span> <span class=o>/</span> <span class=m>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// point where it start to move left/right
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>edgeMidStart</span> <span class=o>=</span> <span class=n>Offset</span><span class=p>(</span><span class=n>edgeStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>mid</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// point where it start to move down again
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>edgeMidEnd</span> <span class=o>=</span> <span class=n>Offset</span><span class=p>(</span><span class=n>edgeEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>mid</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>edgePath</span> <span class=o>=</span> <span class=n>Path</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Move to the starting point
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>..</span><span class=n>moveTo</span><span class=p>(</span><span class=n>edgeStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Make a straight line to the mid leaving space for curve
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span> <span class=o>-</span> <span class=n>_roundedRectangleRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// the curve
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>..</span><span class=n>quadraticBezierTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dx</span> <span class=o>+</span> <span class=p>(</span><span class=n>isLeft</span> <span class=o>?</span> <span class=o>-</span><span class=n>_roundedRectangleRadius</span> <span class=o>:</span> <span class=n>_roundedRectangleRadius</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidStart</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Line which moves horizontally again leaving space for curve
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span> <span class=o>+</span> <span class=p>(</span><span class=n>isLeft</span> <span class=o>?</span> <span class=n>_roundedRectangleRadius</span> <span class=o>:</span> <span class=o>-</span><span class=n>_roundedRectangleRadius</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Another curve
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>..</span><span class=n>quadraticBezierTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeMidEnd</span><span class=p>.</span><span class=n>dy</span> <span class=o>+</span> <span class=n>_roundedRectangleRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Stretch line to the end
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>..</span><span class=n>lineTo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeEnd</span><span class=p>.</span><span class=n>dx</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>edgeEnd</span><span class=p>.</span><span class=n>dy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Paint the base dark green color
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>canvas</span><span class=p>.</span><span class=n>drawPath</span><span class=p>(</span><span class=n>edgePath</span><span class=p>,</span> <span class=n>darkGreenPaint</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=placing-the-components>Placing the components<a hidden class=anchor aria-hidden=true href=#placing-the-components>#</a></h4><p>For simplicity of code I&rsquo;m moving the canvas center from top left to top center by the <a href=https://api.flutter.dev/flutter/dart-ui/Canvas/translate.html>Canvas.translate</a></p><p>Let&rsquo;s take our main node as the reference point to so that things makes sense.</p><p>It will be a bit below the top center hence the following code -</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>paint</span><span class=p>(</span><span class=n>Canvas</span> <span class=n>canvas</span><span class=p>,</span> <span class=n>Size</span> <span class=n>size</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Center canvas horizontally as it becomes easier to make all measurements
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>canvas</span><span class=p>.</span><span class=n>translate</span><span class=p>(</span><span class=n>size</span><span class=p>.</span><span class=n>width</span> <span class=o>/</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Point where you want the root node to be at end (top-center)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>start</span> <span class=o>=</span> <span class=n>Offset</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>outlineRootNodeRadius</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>_paintNode</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>canvas:</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>center:</span> <span class=n>start</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>nodeRadius:</span> <span class=n>rootNodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>outlineNodeRadius:</span> <span class=n>outlineRootNodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>startAngle:</span> <span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>/</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>sweepAngle:</span> <span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>*</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>circlePaint:</span> <span class=n>Paint</span><span class=p>()..</span><span class=n>color</span> <span class=o>=</span> <span class=n>green</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>initialOutlinePaint:</span> <span class=n>darkGreenPaint</span><span class=p>..</span><span class=n>color</span> <span class=o>=</span> <span class=n>darkGreen</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>sweepOutlinePaint:</span> <span class=n>greenPaint</span><span class=p>..</span><span class=n>color</span> <span class=o>=</span> <span class=n>green</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>paint</span><span class=p>(</span><span class=n>Canvas</span> <span class=n>canvas</span><span class=p>,</span> <span class=n>Size</span> <span class=n>size</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Start point of edge
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>edgeStart</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=n>Offset</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>outlineRootNodeRadius</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Note: we will calculate only for right node and for left we will negate it
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=c1>// end point of the edge
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>edgeEnd</span> <span class=o>=</span> <span class=n>edgeStart</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>      <span class=n>Offset</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=c1>// adding padding to have distance between 2 children
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>outlineNodeRadius</span> <span class=o>+</span> <span class=n>_padding</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=c1>// how much space child will need from the bottom
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>size</span><span class=p>.</span><span class=n>height</span> <span class=o>-</span> <span class=p>(</span><span class=n>outlineNodeRadius</span> <span class=o>*</span> <span class=m>2</span><span class=p>)</span> <span class=o>-</span> <span class=n>edgeStart</span><span class=p>.</span><span class=n>dy</span> <span class=o>-</span> <span class=n>_padding</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// position of child node
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>childNode</span> <span class=o>=</span> <span class=n>edgeEnd</span> <span class=o>+</span> <span class=n>Offset</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>outlineNodeRadius</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Right edge
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>_paintEdge</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>canvas:</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>edgeStart:</span> <span class=n>edgeStart</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>edgeEnd:</span> <span class=n>edgeEnd</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>_paintNode</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>canvas:</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>center:</span> <span class=n>childNode</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>nodeRadius:</span> <span class=n>nodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>outlineNodeRadius:</span> <span class=n>outlineNodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>startAngle:</span> <span class=o>-</span><span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>/</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>sweepAngle:</span> <span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>*</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>circlePaint:</span> <span class=n>Paint</span><span class=p>()..</span><span class=n>color</span> <span class=o>=</span> <span class=n>primary</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>initialOutlinePaint:</span> <span class=n>darkGreenPaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>sweepOutlinePaint:</span> <span class=n>greenPaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Left edge
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>_paintEdge</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>canvas:</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>edgeStart:</span> <span class=n>edgeStart</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>edgeEnd:</span> <span class=n>edgeEnd</span><span class=p>.</span><span class=n>scale</span><span class=p>(</span><span class=o>-</span><span class=m>1</span><span class=p>,</span> <span class=m>1</span><span class=p>),</span>          <span class=c1>// negate on x-axis
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nl>isLeft:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>_paintNode</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>canvas:</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>center:</span> <span class=n>childNode</span><span class=p>.</span><span class=n>scale</span><span class=p>(</span><span class=o>-</span><span class=m>1</span><span class=p>,</span> <span class=m>1</span><span class=p>),</span>         <span class=c1>// negate on x-axis
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nl>nodeRadius:</span> <span class=n>nodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>outlineNodeRadius:</span> <span class=n>outlineNodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>startAngle:</span> <span class=o>-</span><span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>/</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>sweepAngle:</span> <span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>*</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>circlePaint:</span> <span class=n>Paint</span><span class=p>()..</span><span class=n>color</span> <span class=o>=</span> <span class=n>primary</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>initialOutlinePaint:</span> <span class=n>darkGreenPaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>sweepOutlinePaint:</span> <span class=n>greenPaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Finally after sooooo much efforts we are able to create a static painting on our canvas.</p><p>Now we can move to the more difficult part that is animating it.</p><h3 id=divide-the-animation-is-parts-and-animate-them>Divide the animation is parts and animate them<a hidden class=anchor aria-hidden=true href=#divide-the-animation-is-parts-and-animate-them>#</a></h3><p>While having working on animating the components we need to look at the bigger picture and think in terms of when the animation starts and when it ends and how it is connected to each other.</p><p>Before we write code it&rsquo;s always better to plan how we are going to do it, as it will make it a lot easier for you to code it and more importantly understand it.</p><p>You can divide when the direction of motion, color, or focus (Object which is animating) of animation changes.</p><blockquote><p>Trust your gut feeling.</p></blockquote><h4 id=tracking-main-nodes-motion>Tracking Main node&rsquo;s motion<a hidden class=anchor aria-hidden=true href=#tracking-main-nodes-motion>#</a></h4><center><video width=50% autoplay loop>
<source src=./videos/animation-1.mp4 type=video/mp4>Full</video></center><p>We just need move the center of our main node from center of the screen to the main position where it should be</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>paint</span><span class=p>(</span><span class=n>Canvas</span> <span class=n>canvas</span><span class=p>,</span> <span class=n>Size</span> <span class=n>size</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Point where you want the root node to be at end (top-center)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>start</span> <span class=o>=</span> <span class=n>Offset</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>outlineRootNodeRadius</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Get center of the screen
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>center</span> <span class=o>=</span> <span class=n>Offset</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>size</span><span class=p>.</span><span class=n>height</span> <span class=o>/</span> <span class=m>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Paint main node
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>_paintNode</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>canvas:</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>center:</span> <span class=n>lerpOffset</span><span class=p>(</span><span class=n>center</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>moveRootToTop</span><span class=p>.</span><span class=n>value</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nl>nodeRadius:</span> <span class=n>rootNodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><code>lerpOffset</code> will move our node from <code>center</code> to <code>start</code> while we can control the percent of movement with <code>moveRootToTop.value</code></p><h4 id=edge-lines-appear>edge lines appear<a hidden class=anchor aria-hidden=true href=#edge-lines-appear>#</a></h4><center><video width=50% autoplay loop>
<source src=./videos/animation-2.mp4 type=video/mp4>Full</video></center><p>The edge lines appear and shifts attention of the user from main head to it. It&rsquo;s very easy, just change opacity from 0 to 1.</p><p>For this we will just update our <code>darkGreenPaint</code> getter to have color with an opacity to it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>Paint</span> <span class=kd>get</span> <span class=n>darkGreenPaint</span> <span class=o>=&gt;</span> <span class=n>Paint</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>color</span> <span class=o>=</span> <span class=n>darkGreen</span><span class=p>.</span><span class=n>withOpacity</span><span class=p>(</span><span class=n>fadeInEdge</span><span class=p>.</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>strokeWidth</span> <span class=o>=</span> <span class=m>5</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>style</span> <span class=o>=</span> <span class=n>PaintingStyle</span><span class=p>.</span><span class=n>stroke</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>strokeCap</span> <span class=o>=</span> <span class=n>StrokeCap</span><span class=p>.</span><span class=n>round</span><span class=p>;</span>
</span></span></code></pre></div><p>We can control the fade in of this with <code>fadeInEdge.value</code>.</p><h4 id=green-color-flows-from-main-node-to-edge-lines>Green color flows from main node to edge lines<a hidden class=anchor aria-hidden=true href=#green-color-flows-from-main-node-to-edge-lines>#</a></h4><center><video width=50% autoplay loop>
<source src=./videos/animation-3.mp4 type=video/mp4>Full</video></center><p>We can see that the color from the outline of main node decreases, to make this we can use <code>sweepAngle</code> and decrease it. Before that to make it easier we can have green color outline stacked on dark green color outline by updating our <code>_paintNode</code> method.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kt>void</span> <span class=n>_paintNode</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=kt>double</span> <span class=n>startAngle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=kt>double</span> <span class=n>sweepAngle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=n>Paint</span> <span class=n>circlePaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=n>Paint</span> <span class=n>initialOutlinePaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=n>Paint</span> <span class=n>sweepOutlinePaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>_paintOutlineCircle</span><span class=p>(</span>
</span></span><span class=line><span class=cl>   <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=nl>paint:</span> <span class=n>initialOutlinePaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>_paintOutlineCircle</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>canvas:</span> <span class=n>canvas</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>startAngle:</span> <span class=n>startAngle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>sweepAngle:</span> <span class=n>sweepAngle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>paint:</span> <span class=n>sweepOutlinePaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>radius:</span> <span class=n>outlineNodeRadius</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>center:</span> <span class=n>center</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Things changed here are that we have sweep angle and 2 paint for outline - initial and sweep</p><p>For main node the sweep angle decreases, (i.e. 2Ï€ to 0) by changing the calling function</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>_paintNode</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=nl>startAngle:</span> <span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>/</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nl>sweepAngle:</span> <span class=n>lerpDouble</span><span class=p>(</span><span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>*</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=n>edgeFill</span><span class=p>.</span><span class=n>value</span><span class=p>)</span><span class=o>!</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nl>initialOutlinePaint:</span> <span class=n>darkGreenPaint</span><span class=p>..</span><span class=n>color</span> <span class=o>=</span> <span class=n>darkGreen</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nl>sweepOutlinePaint:</span> <span class=n>greenPaint</span><span class=p>..</span><span class=n>color</span> <span class=o>=</span> <span class=n>green</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></div><p><code>lerpDouble(math.pi * 2, 0, edgeFill.value)</code> will move from 2Ï€ to 0 controlled by <code>edgeFill.value</code>.</p><p>While it&rsquo;s decreasing we also need to fill the edge lines. Animating lines and curves but I found a neat trick to do this on <a href=https://stackoverflow.com/a/57233047/13268307>stackoverflow</a> by <a href=https://stackoverflow.com/users/4420543/andras>andras</a>.</p><p>Over here they divided the given path into segments and add it to the path till the specified percentage is reached.</p><p>We can use <code>createAnimatedPath</code> function to get the desired animation. Again we will stack it on the dark green color.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kt>void</span> <span class=n>_paintEdge</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Paint the base dark green color
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>canvas</span><span class=p>.</span><span class=n>drawPath</span><span class=p>(</span><span class=n>edgePath</span><span class=p>,</span> <span class=n>darkGreenPaint</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>edgeFill</span><span class=p>.</span><span class=n>value</span> <span class=o>!=</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Paint the green color which comes in 3rd section
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>canvas</span><span class=p>.</span><span class=n>drawPath</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>createAnimatedPath</span><span class=p>(</span><span class=n>edgePath</span><span class=p>,</span> <span class=n>edgeFill</span><span class=p>.</span><span class=n>value</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>greenPaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><code>edgeFill.value</code> here increases the value from 0 to 1 increasing the color filled in edge lines.</p><p>Noticed that the whole animation is controlled by <code>edgeFill.value</code>, it decreased the value for main node outline while increased the color in edge lines.</p><h4 id=green-color-flows-from-edge-lines-to-children>Green color flows from edge lines to children<a hidden class=anchor aria-hidden=true href=#green-color-flows-from-edge-lines-to-children>#</a></h4><center><video width=50% autoplay loop>
<source src=./videos/animation-4.mp4 type=video/mp4>Full</video></center><p>This is exact opposite of what we did in previous step. The edge lines decrease and children node outline increases.</p><p>Like the question <a href=https://en.wikipedia.org/wiki/Is_the_glass_half_empty_or_half_full%3F>&lsquo;Is the glass half empty or half full?&rsquo;</a> we can say that the edge lines are filling with dark green color instead of draining dark green color as it&rsquo;s a bit difficult to handle.</p><p>We will stack filling dark green color lines on the existing stack</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kt>void</span> <span class=n>_paintEdge</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>childrenFill</span><span class=p>.</span><span class=n>value</span> <span class=o>!=</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Paint it again dark green for final section
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>canvas</span><span class=p>.</span><span class=n>drawPath</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>createAnimatedPath</span><span class=p>(</span><span class=n>edgePath</span><span class=p>,</span> <span class=n>lerpDouble</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=n>childrenFill</span><span class=p>.</span><span class=n>value</span><span class=p>)</span><span class=o>!</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>darkGreenPaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This is handled by <code>childrenFill.value</code> and we will use the same thing for all the animations in this section.</p><p>To fill the outline of children nodes we will increase the <code>sweepAngle</code> from 0 to 2Ï€ and fade in the circles at the same time.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>_paintNode</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=nl>startAngle:</span> <span class=o>-</span><span class=n>math</span><span class=p>.</span><span class=n>pi</span> <span class=o>/</span> <span class=m>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nl>sweepAngle:</span> <span class=n>lerpDouble</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>2</span> <span class=o>*</span> <span class=n>math</span><span class=p>.</span><span class=n>pi</span><span class=p>,</span> <span class=n>childrenFill</span><span class=p>.</span><span class=n>value</span><span class=p>)</span><span class=o>!</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nl>circlePaint:</span> <span class=n>Paint</span><span class=p>()..</span><span class=n>color</span> <span class=o>=</span> <span class=n>primary</span><span class=p>.</span><span class=n>withOpacity</span><span class=p>(</span><span class=n>childrenFill</span><span class=p>.</span><span class=n>value</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nl>initialOutlinePaint:</span> <span class=n>darkGreenPaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nl>sweepOutlinePaint:</span> <span class=n>greenPaint</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></div><h4 id=orchestrating-these-animations>Orchestrating these animations<a hidden class=anchor aria-hidden=true href=#orchestrating-these-animations>#</a></h4><p>You might think what are these <code>moveRootToTop</code>, <code>fadeInEdge</code>, <code>edgeFill</code>, and <code>childrenFill</code>? These are technically variables with <code>Animation&lt;double></code> type, I use them to orchestrate the animation. <code>AnimationController</code> while controls the animation, we can attach the controller to multiple <code>Animation&lt;T></code> to have finer control. Using <a href=https://api.flutter.dev/flutter/animation/CurvedAnimation-class.html>CurvedAnimation</a> to have different <a href=https://api.flutter.dev/flutter/animation/Curves-class.html>Curves</a> and <a href=https://api.flutter.dev/flutter/animation/Interval-class.html>Interval</a> to define the interval in which the <code>Animation</code> should start and end, for example - start at 20% and end at 60% of animation duration will be written as <code>Interval(0.2, 0.6)</code>. Finally all this will be packed in a <a href=https://api.flutter.dev/flutter/animation/Tween-class.html>Tween</a> where you will define the start and end value of the animation.</p><p>This will look like -</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>animation</span> <span class=o>=</span> <span class=n>Tween</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span><span class=p>(</span><span class=nl>begin:</span> <span class=m>0</span><span class=p>,</span> <span class=nl>end:</span> <span class=m>1</span><span class=p>).</span><span class=n>animate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>CurvedAnimation</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nl>parent:</span> <span class=n>animationController</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nl>curve:</span> <span class=kd>const</span> <span class=n>Interval</span><span class=p>(</span><span class=m>0.1</span><span class=p>,</span> <span class=m>0.2</span><span class=p>,</span> <span class=nl>curve:</span> <span class=n>Curves</span><span class=p>.</span><span class=n>easeInOut</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></div><p>I read it from inside out - start the animation at 10% and end it at 20% following <em>ease-in-out</em> curve, it will be controlled by the <code>animationController</code> and the value will move from 0 to 1.</p><p>Coming back to our animation -</p><p>You can define it as late variable and then assign it in the contructor of the class.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>late</span> <span class=kd>final</span> <span class=n>Animation</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span> <span class=n>edgeFill</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>fadeInEdge</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>fadeInChildren</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>moveRootToTop</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>TreeSplitAnimationPainter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=kd>required</span> <span class=n>AnimationController</span> <span class=n>animationController</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Tween that moved the root node up as soon as animation starts
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>moveRootToTop</span> <span class=o>=</span> <span class=n>Tween</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span><span class=p>(</span><span class=nl>begin:</span> <span class=m>0</span><span class=p>,</span> <span class=nl>end:</span> <span class=m>1</span><span class=p>).</span><span class=n>animate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>CurvedAnimation</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nl>parent:</span> <span class=n>animationController</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nl>curve:</span> <span class=kd>const</span> <span class=n>Interval</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0.2</span><span class=p>,</span> <span class=nl>curve:</span> <span class=n>Curves</span><span class=p>.</span><span class=n>easeInOut</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Shows the dark green colored edges
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>fadeInEdge</span> <span class=o>=</span> <span class=n>Tween</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span><span class=p>(</span><span class=nl>begin:</span> <span class=m>0</span><span class=p>,</span> <span class=nl>end:</span> <span class=m>1</span><span class=p>).</span><span class=n>animate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>CurvedAnimation</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nl>parent:</span> <span class=n>animationController</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nl>curve:</span> <span class=kd>const</span> <span class=n>Interval</span><span class=p>(</span><span class=m>0.2</span><span class=p>,</span> <span class=m>0.3</span><span class=p>,</span> <span class=nl>curve:</span> <span class=n>Curves</span><span class=p>.</span><span class=n>easeInOut</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Fills the dark green colored edges with green color
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// and removes green from the outline of root node
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>edgeFill</span> <span class=o>=</span> <span class=n>Tween</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span><span class=p>(</span><span class=nl>begin:</span> <span class=m>0</span><span class=p>,</span> <span class=nl>end:</span> <span class=m>1</span><span class=p>).</span><span class=n>animate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>CurvedAnimation</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nl>parent:</span> <span class=n>animationController</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nl>curve:</span> <span class=kd>const</span> <span class=n>Interval</span><span class=p>(</span><span class=m>0.3</span><span class=p>,</span> <span class=m>0.7</span><span class=p>,</span> <span class=nl>curve:</span> <span class=n>Curves</span><span class=p>.</span><span class=n>easeInOut</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Show the children nodes inside the outline
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>fadeInChildren</span> <span class=o>=</span> <span class=n>Tween</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span><span class=p>(</span><span class=nl>begin:</span> <span class=m>0</span><span class=p>,</span> <span class=nl>end:</span> <span class=m>1</span><span class=p>).</span><span class=n>animate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>CurvedAnimation</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nl>parent:</span> <span class=n>animationController</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nl>curve:</span> <span class=kd>const</span> <span class=n>Interval</span><span class=p>(</span><span class=m>0.7</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=nl>curve:</span> <span class=n>Curves</span><span class=p>.</span><span class=n>easeInOut</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Finally we can use this custom painter in our app!! But before that I would like to suggest you some of the optimizations for the app.</p><h3 id=optimize-the-animation>Optimize the animation<a hidden class=anchor aria-hidden=true href=#optimize-the-animation>#</a></h3><p>Optimizing the canvas animations is not that difficult you just need to be away what are you doing and anything you do may or may not have impact on memory, so beware do it only if you need it.</p><blockquote><p>Premature optimization is the root of evil.</p></blockquote><hr><p>Pass your <code>AnimationController</code> to the <code>repaint</code> property in the <code>CustomPainter</code> constructor.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>class</span> <span class=nc>TreeSplitAnimationPainter</span> <span class=kd>extends</span> <span class=n>CustomPainter</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>TreeSplitAnimationPainter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=kd>required</span> <span class=n>AnimationController</span> <span class=n>animationController</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span> <span class=o>:</span> <span class=k>super</span><span class=p>(</span><span class=nl>repaint:</span> <span class=n>animationController</span><span class=p>);</span>             <span class=c1>// Pass the controller here
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><hr><p>Never do set <code>shouldRepaint</code> to <code>true</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Sky</span> <span class=kd>extends</span> <span class=n>CustomPainter</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>Sky</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>color</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>Color</span> <span class=n>color</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=kt>void</span> <span class=n>paint</span><span class=p>(</span><span class=n>canvas</span><span class=p>,</span> <span class=n>size</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Don&#39;t do this
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=kt>bool</span> <span class=n>shouldRepaint</span><span class=p>(</span><span class=n>Sky</span> <span class=n>oldDelegate</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Always specify <code>shouldRepaint</code> to react to changes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Sky</span> <span class=kd>extends</span> <span class=n>CustomPainter</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>Sky</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>color</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>Color</span> <span class=n>color</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=kt>void</span> <span class=n>paint</span><span class=p>(</span><span class=n>canvas</span><span class=p>,</span> <span class=n>size</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Do do this
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=kt>bool</span> <span class=n>shouldRepaint</span><span class=p>(</span><span class=n>Sky</span> <span class=n>oldDelegate</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=n>color</span> <span class=o>!=</span> <span class=n>oldDelegate</span><span class=p>.</span><span class=n>color</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><hr><p>Set <code>isComplex</code> to <code>true</code> in <code>CustomPaint</code> widget</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>CustomPaint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=nl>isComplex:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>),</span>
</span></span></code></pre></div><p>This will cache images of the CustomPaint.</p><hr><p>If an animation causes random rebuilds of your screen you can use <a href=https://api.flutter.dev/flutter/widgets/RepaintBoundary-class.html>RepaintBoundary</a> widget. It separates it&rsquo;s children from the parent while repainting.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>RepaintBoundary</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nl>child:</span> <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><h3 id=code-and-thanks-note>Code and Thanks note<a hidden class=anchor aria-hidden=true href=#code-and-thanks-note>#</a></h3><p>You can go to <a href="https://zapp.run/edit/tree-split-animation-zlt6069tlt70?entry=lib/main.dart&amp;file=lib/tree_split_animation.dart">this site</a> to play around with the code and test the code yourself.</p><p>Thanks a lot for reading this long blog! I really enjoy working with animations and CustomPainter in flutter, do connect with me over my <a href=https://links.darshanrander.com>socials</a> if you want to have a chat or need any help.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://blog.darshanrander.com/posts/diary/the-real-truth/><span class=title>Next Â»</span><br><span>The Real Truth</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Animating Canvas in Flutter (Draft) on twitter" href="https://twitter.com/intent/tweet/?text=Animating%20Canvas%20in%20Flutter%20%28Draft%29&amp;url=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fanimating-canvas-in-flutter%2f&amp;hashtags=Flutter%2cDart%2cUI%2cCustomPainter%2cAnimation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Animating Canvas in Flutter (Draft) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fanimating-canvas-in-flutter%2f&amp;title=Animating%20Canvas%20in%20Flutter%20%28Draft%29&amp;summary=Animating%20Canvas%20in%20Flutter%20%28Draft%29&amp;source=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fanimating-canvas-in-flutter%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Animating Canvas in Flutter (Draft) on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fanimating-canvas-in-flutter%2f&title=Animating%20Canvas%20in%20Flutter%20%28Draft%29"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Animating Canvas in Flutter (Draft) on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fanimating-canvas-in-flutter%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Animating Canvas in Flutter (Draft) on whatsapp" href="https://api.whatsapp.com/send?text=Animating%20Canvas%20in%20Flutter%20%28Draft%29%20-%20https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fanimating-canvas-in-flutter%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Animating Canvas in Flutter (Draft) on telegram" href="https://telegram.me/share/url?text=Animating%20Canvas%20in%20Flutter%20%28Draft%29&amp;url=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fanimating-canvas-in-flutter%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>Â© 2022 <a href=https://darshanrander.com>Darshan Rander</a> |</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>