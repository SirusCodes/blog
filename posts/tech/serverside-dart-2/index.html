<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Serverside Dart #2 | Darshan's Blog</title>
<meta name=keywords content="Server,Backend,Dart,Benchmark,Tech"><meta name=description content="A comparison between serverside frameworks in Dart and other languages"><meta name=author content="Darshan Rander"><link rel=canonical href=https://blog.darshanrander.com/posts/tech/serverside-dart-2/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://blog.darshanrander.com/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.darshanrander.com/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.darshanrander.com/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.darshanrander.com/favicons/apple-touch-icon.png><link rel=mask-icon href=https://blog.darshanrander.com/favicons/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.darshanrander.com/posts/tech/serverside-dart-2/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async defer src=https://analytics.darshanrander.com/script.js data-website-id=900abcb8-7747-4813-8b7d-9fa5caebe82c></script><meta property="og:url" content="https://blog.darshanrander.com/posts/tech/serverside-dart-2/"><meta property="og:site_name" content="Darshan's Blog"><meta property="og:title" content="Serverside Dart #2"><meta property="og:description" content="A comparison between serverside frameworks in Dart and other languages"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-08T00:18:00+05:30"><meta property="article:modified_time" content="2023-04-08T00:18:00+05:30"><meta property="og:image" content="https://blog.darshanrander.com/posts/tech/serverside-dart-2/images/cover.png"><meta property="og:see_also" content="https://blog.darshanrander.com/posts/tech/how-i-wrote-my-language/"><meta property="og:see_also" content="https://blog.darshanrander.com/posts/tech/animating-canvas-in-flutter/"><meta property="og:see_also" content="https://blog.darshanrander.com/posts/tech/serverside-dart/"><meta property="og:see_also" content="https://blog.darshanrander.com/posts/tech/how-i-wrote-my-language/"><meta property="og:see_also" content="https://blog.darshanrander.com/posts/tech/serverside-dart/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.darshanrander.com/posts/tech/serverside-dart-2/images/cover.png"><meta name=twitter:title content="Serverside Dart #2"><meta name=twitter:description content="A comparison between serverside frameworks in Dart and other languages"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.darshanrander.com/posts/"},{"@type":"ListItem","position":2,"name":"Tech","item":"https://blog.darshanrander.com/posts/tech/"},{"@type":"ListItem","position":3,"name":"Serverside Dart #2","item":"https://blog.darshanrander.com/posts/tech/serverside-dart-2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Serverside Dart #2","name":"Serverside Dart #2","description":"A comparison between serverside frameworks in Dart and other languages","keywords":["Server","Backend","Dart","Benchmark","Tech"],"articleBody":"Hey everyone!\nThis is the second edition of Server-side Dart. I would recommend reading the first edition before this. But if you are lazy like me TL;DR - Dart servers are slow in multipart requests and JSON parsing.\nIn this edition, I have included a few more frameworks, updates to the SirusCodes/backend_benchmark repository and some load testing.\nIn this blog, I have compared the following frameworks:\nDart Conduit (v4.3.9) Shelf (v1.4.0) dart_frog (v0.3.5) dia (v0.1.5) minerva (v0.3.3) spry (v2.1.1) Go fiber (v2.43.0) Python Flask (v2.2.3) Node Express (v4.18.2) Benchmarks The code for the benchmarks is at SirusCodes/backend_benchmark. Please open an issue if you find any issues in the benchmarks.\nI got the below results by running the benchmark and servers on GitHub Actions.\nCustom benchmarks The benchmarks are testing backends on 4 bases\nSynchronous request handling Asynchronous request handling Multi-part requests (File upload) JSON parsing Lesser means better\nThese show a similar pattern to the first edition, the only difference here we have a few more frameworks.\nSend one request at a time Send multiple request at a time Send files with multipart Send 1.04MB of JSON to server and let it parse it The results are similar to previous edition, Dart Frameworks have some scope for improvement in JSON parsing and Multipart file requests.\nLoad testing For load testing, I have used k6, which is a load-testing tool that can simulate users on an endpoint.\nYou can have a look at the config file on how it works.\nA TL;DR would be it simulates the user increasing from 0 to 50, staying there for a minute then increasing to 100 and so on till it reaches 200 in steps of 50 and then decreases in steps of 100 till it reaches 0.\nIn the graphs below the Red line, represents the number of virtual/simulated users and the Blue line, represents the Average round trip time (ms) on the Y-axes and the time for test on X-axis.\nConduit (Dart) RTT starts at 1.2ms and drops to 0.5ms when VUs(Virtual users) reach 100 and stays around 0.5ms and 0.8ms till the end.\nDia (Dart) Similar to conduit it start around 1.4ms and drops to 0.5ms at 100 VUs then maintains a steady 0.8ms RTT till the end.\ndart_frog (Dart) dart_frog starts with 1.9ms RTT and drops to 0.8ms RTT at 100 VUs then slightly increases to 1ms at 200 VUs.\nminerva (Dart) Minerva has a good start at 0.5ms and goes as low as 0.3ms RTT and goes to a maximum of 0.8ms even at a peak of 200 VUs but generally stays around 0.6ms.\nThere is a good reason why Minerva is performing so well, more on that later.\nshelf (Dart) Shelf starts with 1.5ms RTT and drops to 1.1ms RTT and stays steady till 50 VUs and then drops even further to 0.6ms RTT and gradually increases to 1ms with an increase in VUs.\nspry (Dart) It starts with 1.4ms RTT and drops to around 1.15ms RTT and stays steady then drops even further till 0.6ms RTT and gradually increases to 0.8ms with an increase in VUs.\nexpressjs (Node) Express starts at 1ms RTT and goes down to 0.7ms RTT till 50 VUs gradually increase and stays steady around 1ms and 1.2ms RTT.\nFlask (Python) Flask starts with 0.8ms RTT and increases a bit to 1ms RTT and again decreases to 0.8ms RTT and gradually increases to 1.3ms RTT with some unusual spikes here and there.\nFiber (Go) As expected Go has the best results in all the backend frameworks. It starts with 0.3ms RTT and follows the graph of numbers of VUs and increases maximum to 0.45ms RTT.\nConcluding benchmarks From custom benchmarks, we can say that for normal requests Dart backends are comparable to other Languages but they are pretty slow when it comes to multipart files or if we want to send huge JSON data (which is very less likely) but we know that Dartâ€™s native JSON parsers are pretty slow.\nThough there are a few packages that are faster than the native parser like crimson.\nMultipart files are slow as of now but Iâ€™m pretty optimistic about it as well.\nFeatures and code snippets Conduit (Dart) class DartConduitChannel extends ApplicationChannel { @override Controller get entryPoint { final router = Router(); router.route(\"/echo\").linkFunction((request) async { if (request.method == \"POST\") { final body = await request.body.decode\u003cMap\u003cString, dynamic\u003e\u003e(); return Response.ok({\"response\": \"Hello, ${body[\"name\"]}!\"}); } return Response.notFound(); }); return router; } } Conduit is a successor of Aqueduct (another dart framework). You can create Controllers to handle each path and can link/chain them to apply rules (eg. authentication/authorization).\nIt has an inbuilt ORM and OAuth 2.0 security models.\nThe thing that I donâ€™t like about it is that it lacks documentation and itâ€™s too verbose.\nDia (Dart) void main(List\u003cString\u003e args) async { final app = App(); final router = Router('/'); router.post('/echo', (ctx, next) async { final map = ctx.parsed; ctx.body = json.encode({\"response\": \"Hello, ${map[\"name\"]}!\"}); }); app.use(body()); app.use(router.middleware); app.listen(\"127.0.0.1\", 8080); } Dia is a simple framework with APIs similar to Express.\nIt has separate packages for body parsing, CORS middleware, router and static server.\nShoutout to Andrey Unger for contributing to the repository.\ndart_frog (Dart) Future\u003cResponse\u003e onRequest(RequestContext context) async { if (context.request.method== HttpMethod.post) { final body = await context. request.json() as Map\u003cString, dynamic\u003e; return Response.json(body: {response: \"Hello, ${body[\"name\"]}!\"}); } return Response( statusCode: HttpStatus.notFound); } dart_frog is one of my favorite frameworks in terms of API design as it supports file-based routing. So you can make files and directories instead of writing routes manually. It would be great if we could avoid writing if/else statements to check the kind of requests.\nUnder the hood it generates shelf code so you can use almost all the packages made for shelf.\nNow it also supports multipart form requests which lacking when I was writing the previous blog.\nminerva (Dart) class EndpointsBuilder extends MinervaEndpointsBuilder { @override void build(Endpoints endpoints) { endpoints.post('/echo', _echo); } dynamic _echo(ServerContext context, MinervaRequest request) async { var json = await request.body.asJson(); return {\"response\": \"Hello, ${json['name']}!\"}; } } Minvera sits kinda in the middle of easy and complex enough. I havenâ€™t worked with it a lot but from the docs, I can say that it has all the things you might need. I would love to see if the APIs could be simplified more without minerva_controller_generator.\nThe developer also maintains packages that could be used outside of minerva like emerald for JSON parsing, mcache for caching values.\nIt performed well in load testing because of how it is built, so if the load increases it might increase server instances.\nYou can read more about the framework design from the documentation.\nShoutout to Gleb Batykov for contributing to the repository.\nshelf (Dart) final _router = Router() ..post('/echo', _echoHandler); Future\u003cResponse\u003e _echoHandler(Request request) async { final string = await request.readAsString(); final body = json.decode(string); return Response.ok(json.encode({\"response\": \"Hello, ${body[\"name\"]}!\"})); } void main(List\u003cString\u003e args) async { final ip = InternetAddress(\"127.0.0.1\"); final handler = Pipeline().addHandler(_router); final port = int.parse(Platform.environment['PORT'] ?? '8080'); final server = await serve(handler, ip, port); } Shelf is developed and maintained by the Dart team. It is very barebones and asks you to do a lot of stuff on your own.\nIt has packages for routing, handling form data(3rd party) and a lot more developed by the Dart team and individual developers.\nspry (Dart) void main(List\u003cString\u003e arguments) { final spry = Spry(); final router = Router(); router.post(\"/echo\", (context) async { final name = (await context.request.json)[\"name\"]; context.response.json({\"message\": \"Hello $name!\"}); }); spry.listen(router, port: 8080); } Spry is another one of my favorite frameworks not only because it has a cute name but also because it is very flexible. If you like to define routes you can use their spry_router package or if you are like me and loves file-based routing you can have spry_fsrouter and which has a lot of first-party packages.\nexpressjs (Node) const express = require(\"express\"); const expressFileUpload = require(\"express-fileupload\"); const bodyParser = require(\"body-parser\"); const app = express(); app.use(bodyParser.json({ limit: \"50mb\", strict: false })); app.post(\"/echo\", (req, res) =\u003e { res.send(JSON.stringify({ response: `Hello, ${req.body.name}!` })); }); app.listen(8080, \"127.0.0.1\"); It is the most famous framework for writing servers in JS/TS and has been there for a long time.\nFlask (Python) @app.route('/echo', methods=['POST']) def echo(): body = request.get_json() return jsonify({\"response\": f\"Hello, {body['name']}!\"}) if __name__ == '__main__': app.run() It is a very simple and easy-to-use Python framework. If you like it then I would also suggest you try FastAPI.\nFiber (Go) func main() { app := fiber.New() app.Post(\"/echo\", func(c *fiber.Ctx) error { type User struct { Name string `json:\"name\"` } user := new(User) if err := c.BodyParser(user); err != nil { return err } return c.JSON(fiber.Map{\"response\": \"Hello, \" + user.Name + \"!\"}) }) app.Listen(\":8080\") } Fiber is the fastest framework in the results of our benchmark which was kind of expected as it is written in Golang. But go is not a language that everyone uses and itâ€™s a bit difficult to start with as itâ€™s a very minimal language. If you like minimal languages then Go is your perfect partner.\nConcluding features and code Coding style depends on person to person you might like something which I might not, look at the basic snippets and choose what you like because most of the features basic will be available for all the frameworks and you can always implement your own thing as you go.\nIâ€™m also interested in Serverpod, it brings in a lot of features and itâ€™s also an end-to-end solution for building a Dart server and Flutter app. Not touching it right now as it looks a bit complicated ðŸ˜…\nInfrastructure Support A lot of platforms support Dart deployment such as -\nGoogle Cloud Run AWS Lambda Appwrite DigitalOcean App Platform Dart Edge Dart Edge is a project by Invertase to run Dart on Edge function by transpiling it to JS (or WASM soon).\nCurrently, it only supports Cloudflare Workers, and Vercel Edge Functions and plans to support more in the future.\nFinal thoughts Right now I feel Dart backends are going in the right direction and it would be a good time to start learning. Still wouldnâ€™t suggest building your billion-dollar company (maybe in a few years ðŸ¤ž) on it as it would be difficult to find a developer who would love to write Dart backend or hire me.\n","wordCount":"1712","inLanguage":"en","image":"https://blog.darshanrander.com/posts/tech/serverside-dart-2/images/cover.png","datePublished":"2023-04-08T00:18:00+05:30","dateModified":"2023-04-08T00:18:00+05:30","author":{"@type":"Person","name":"Darshan Rander"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.darshanrander.com/posts/tech/serverside-dart-2/"},"publisher":{"@type":"Organization","name":"Darshan's Blog","logo":{"@type":"ImageObject","url":"https://blog.darshanrander.com/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.darshanrander.com/ accesskey=h title="Darshan's Blog (Alt + H)">Darshan's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.darshanrander.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.darshanrander.com/series/ title=Series><span>Series</span></a></li><li><a href=https://blog.darshanrander.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://darshanrander.com title=darshanrander.com><span>darshanrander.com</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.darshanrander.com/>Home</a>&nbsp;Â»&nbsp;<a href=https://blog.darshanrander.com/posts/>Posts</a>&nbsp;Â»&nbsp;<a href=https://blog.darshanrander.com/posts/tech/>Tech</a></div><h1 class="post-title entry-hint-parent">Serverside Dart #2</h1><div class=post-meta><span title='2023-04-08 00:18:00 +0530 +0530'>April 8, 2023</span>&nbsp;Â·&nbsp;9 min&nbsp;Â·&nbsp;1712 words&nbsp;Â·&nbsp;Darshan Rander&nbsp;|&nbsp;<a href=https://github.com/SirusCodes/blog/tree/main/content/posts/tech/serverside-dart-2/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager srcset="https://blog.darshanrander.com/posts/tech/serverside-dart-2/images/cover_hu_6fe1d6a3ae4ab34.png 360w ,https://blog.darshanrander.com/posts/tech/serverside-dart-2/images/cover_hu_3d27ce7495e80a0b.png 480w ,https://blog.darshanrander.com/posts/tech/serverside-dart-2/images/cover_hu_45c99c8f8dece62f.png 720w ,https://blog.darshanrander.com/posts/tech/serverside-dart-2/images/cover.png 1024w" sizes="(min-width: 768px) 720px, 100vw" src=https://blog.darshanrander.com/posts/tech/serverside-dart-2/images/cover.png alt="Server-side Dart cover photo" width=1024 height=512></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#benchmarks aria-label=Benchmarks>Benchmarks</a><ul><li><a href=#custom-benchmarks aria-label="Custom benchmarks">Custom benchmarks</a></li><li><a href=#load-testing aria-label="Load testing">Load testing</a><ul><li><a href=#conduit-dart aria-label="Conduit (Dart)">Conduit (Dart)</a></li><li><a href=#dia-dart aria-label="Dia (Dart)">Dia (Dart)</a></li><li><a href=#dart_frog-dart aria-label="dart_frog (Dart)">dart_frog (Dart)</a></li><li><a href=#minerva-dart aria-label="minerva (Dart)">minerva (Dart)</a></li><li><a href=#shelf-dart aria-label="shelf (Dart)">shelf (Dart)</a></li><li><a href=#spry-dart aria-label="spry (Dart)">spry (Dart)</a></li><li><a href=#expressjs-node aria-label="expressjs (Node)">expressjs (Node)</a></li><li><a href=#flask-python aria-label="Flask (Python)">Flask (Python)</a></li><li><a href=#fiber-go aria-label="Fiber (Go)">Fiber (Go)</a></li></ul></li><li><a href=#concluding-benchmarks aria-label="Concluding benchmarks">Concluding benchmarks</a></li></ul></li><li><a href=#features-and-code-snippets aria-label="Features and code snippets">Features and code snippets</a><ul><ul><li><a href=#conduit-dart-1 aria-label="Conduit (Dart)">Conduit (Dart)</a></li><li><a href=#dia-dart-1 aria-label="Dia (Dart)">Dia (Dart)</a></li><li><a href=#dart_frog-dart-1 aria-label="dart_frog (Dart)">dart_frog (Dart)</a></li><li><a href=#minerva-dart-1 aria-label="minerva (Dart)">minerva (Dart)</a></li><li><a href=#shelf-dart-1 aria-label="shelf (Dart)">shelf (Dart)</a></li><li><a href=#spry-dart-1 aria-label="spry (Dart)">spry (Dart)</a></li><li><a href=#expressjs-node-1 aria-label="expressjs (Node)">expressjs (Node)</a></li><li><a href=#flask-python-1 aria-label="Flask (Python)">Flask (Python)</a></li><li><a href=#fiber-go-1 aria-label="Fiber (Go)">Fiber (Go)</a></li></ul><li><a href=#concluding-features-and-code aria-label="Concluding features and code">Concluding features and code</a></li></ul></li><li><a href=#infrastructure-support aria-label="Infrastructure Support">Infrastructure Support</a><ul><li><a href=#dart-edge aria-label="Dart Edge">Dart Edge</a></li></ul></li><li><a href=#final-thoughts aria-label="Final thoughts">Final thoughts</a></li></ul></div></details></div><div class=post-content><p>Hey everyone!</p><p>This is the second edition of Server-side Dart. I would recommend reading the <a href=https://blog.darshanrander.com/posts/tech/serverside-dart/>first edition</a> before this. But if you are lazy like me TL;DR - Dart servers are slow in multipart requests and JSON parsing.</p><p>In this edition, I have included a few more frameworks, updates to the <a href=https://github.com/SirusCodes/backend_benchmark>SirusCodes/backend_benchmark</a> repository and some load testing.</p><p>In this blog, I have compared the following frameworks:</p><ul><li>Dart<ul><li><a href=https://www.theconduit.dev/>Conduit</a> (v4.3.9)</li><li><a href=https://pub.dev/packages/shelf/>Shelf</a> (v1.4.0)</li><li><a href=https://dartfrog.vgv.dev/>dart_frog</a> (v0.3.5)</li><li><a href=https://pub.dev/packages/dia>dia</a> (v0.1.5)</li><li><a href=https://pub.dev/packages/minerva/>minerva</a> (v0.3.3)</li><li><a href=https://spry.fun/>spry</a> (v2.1.1)</li></ul></li><li>Go<ul><li><a href=https://gofiber.io>fiber</a> (v2.43.0)</li></ul></li><li>Python<ul><li><a href=https://flask.palletsprojects.com/en/2.2.x/>Flask</a> (v2.2.3)</li></ul></li><li>Node<ul><li><a href=https://expressjs.com/>Express</a> (v4.18.2)</li></ul></li></ul><h1 id=benchmarks>Benchmarks<a hidden class=anchor aria-hidden=true href=#benchmarks>#</a></h1><p>The code for the benchmarks is at <a href=https://github.com/SirusCodes/backend_benchmark>SirusCodes/backend_benchmark</a>. Please <a href=https://github.com/SirusCodes/backend_benchmark/issues/new>open an issue</a> if you find any issues in the benchmarks.</p><p>I got the below results by running the benchmark and servers on GitHub Actions.</p><h2 id=custom-benchmarks>Custom benchmarks<a hidden class=anchor aria-hidden=true href=#custom-benchmarks>#</a></h2><p>The benchmarks are testing backends on 4 bases</p><ol><li>Synchronous request handling</li><li>Asynchronous request handling</li><li>Multi-part requests (File upload)</li><li>JSON parsing</li></ol><blockquote><p><em>Lesser means better</em></p></blockquote><p>These show a similar pattern to the <a href=https://blog.darshanrander.com/posts/tech/serverside-dart/#benchmarks>first edition</a>, the only difference here we have a few more frameworks.</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><figure><img loading=lazy src=images/benchmarks/performance/sync.jpeg><figcaption>Send one request at a time</figcaption></figure></td><td><figure><img loading=lazy src=images/benchmarks/performance/async.jpeg><figcaption>Send multiple request at a time</figcaption></figure></td></tr><tr><td><figure><img loading=lazy src=images/benchmarks/performance/multipart.jpeg><figcaption>Send files with multipart</figcaption></figure></td><td><figure><img loading=lazy src=images/benchmarks/performance/json.jpeg><figcaption>Send 1.04MB of JSON to server and let it parse it</figcaption></figure></td></tr></tbody></table><p>The results are similar to previous edition, Dart Frameworks have some scope for improvement in JSON parsing and Multipart file requests.</p><h2 id=load-testing>Load testing<a hidden class=anchor aria-hidden=true href=#load-testing>#</a></h2><p>For load testing, I have used <a href=https://k6.io>k6</a>, which is a load-testing tool that can simulate users on an endpoint.</p><p>You can have a look at the <a href=https://github.com/SirusCodes/backend_benchmark/blob/main/scripts/k6_load_testing.js>config file</a> on how it works.</p><p>A <strong>TL;DR</strong> would be it simulates the user increasing from 0 to 50, staying there for a minute then increasing to 100 and so on till it reaches 200 in steps of 50 and then decreases in steps of 100 till it reaches 0.</p><p>In the graphs below the <em><strong>Red line</strong></em>, represents the number of <strong>virtual/simulated users</strong> and the <em><strong>Blue line</strong></em>, represents the <strong>Average round trip time (ms)</strong> on the <strong>Y-axes</strong> and the <strong>time for test</strong> on <strong>X-axis</strong>.</p><h3 id=conduit-dart>Conduit (Dart)<a hidden class=anchor aria-hidden=true href=#conduit-dart>#</a></h3><p><img alt="Conduit (Dart)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/dart_conduit.jpeg></p><p>RTT starts at 1.2ms and drops to 0.5ms when VUs(Virtual users) reach 100 and stays around 0.5ms and 0.8ms till the end.</p><h3 id=dia-dart>Dia (Dart)<a hidden class=anchor aria-hidden=true href=#dia-dart>#</a></h3><p><img alt="Dia (Dart)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/dart_dia.jpeg></p><p>Similar to conduit it start around 1.4ms and drops to 0.5ms at 100 VUs then maintains a steady 0.8ms RTT till the end.</p><h3 id=dart_frog-dart>dart_frog (Dart)<a hidden class=anchor aria-hidden=true href=#dart_frog-dart>#</a></h3><p><img alt="dart_frog (Dart)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/dart_frog_backend.jpeg></p><p>dart_frog starts with 1.9ms RTT and drops to 0.8ms RTT at 100 VUs then slightly increases to 1ms at 200 VUs.</p><h3 id=minerva-dart>minerva (Dart)<a hidden class=anchor aria-hidden=true href=#minerva-dart>#</a></h3><p><img alt="minerva (Dart)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/dart_minerva.jpeg></p><p>Minerva has a good start at 0.5ms and goes as low as 0.3ms RTT and goes to a maximum of 0.8ms even at a peak of 200 VUs but generally stays around 0.6ms.</p><p>There is a good reason why Minerva is performing so well, more on that later.</p><h3 id=shelf-dart>shelf (Dart)<a hidden class=anchor aria-hidden=true href=#shelf-dart>#</a></h3><p><img alt="shelf (Dart)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/dart_shelf.jpeg></p><p>Shelf starts with 1.5ms RTT and drops to 1.1ms RTT and stays steady till 50 VUs and then drops even further to 0.6ms RTT and gradually increases to 1ms with an increase in VUs.</p><h3 id=spry-dart>spry (Dart)<a hidden class=anchor aria-hidden=true href=#spry-dart>#</a></h3><p><img alt="spry (Dart)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/dart_spry.jpeg></p><p>It starts with 1.4ms RTT and drops to around 1.15ms RTT and stays steady then drops even further till 0.6ms RTT and gradually increases to 0.8ms with an increase in VUs.</p><h3 id=expressjs-node>expressjs (Node)<a hidden class=anchor aria-hidden=true href=#expressjs-node>#</a></h3><p><img alt="expressjs (Node)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/node_express.jpeg></p><p>Express starts at 1ms RTT and goes down to 0.7ms RTT till 50 VUs gradually increase and stays steady around 1ms and 1.2ms RTT.</p><h3 id=flask-python>Flask (Python)<a hidden class=anchor aria-hidden=true href=#flask-python>#</a></h3><p><img alt="Flask (Python)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/py_flask.jpeg></p><p>Flask starts with 0.8ms RTT and increases a bit to 1ms RTT and again decreases to 0.8ms RTT and gradually increases to 1.3ms RTT with some unusual spikes here and there.</p><h3 id=fiber-go>Fiber (Go)<a hidden class=anchor aria-hidden=true href=#fiber-go>#</a></h3><p><img alt="Fiber (Go)" loading=lazy src=/posts/tech/serverside-dart-2/images/benchmarks/load_testing/go_fiber.jpeg></p><p>As expected Go has the best results in all the backend frameworks. It starts with 0.3ms RTT and follows the graph of numbers of VUs and increases maximum to 0.45ms RTT.</p><h2 id=concluding-benchmarks>Concluding benchmarks<a hidden class=anchor aria-hidden=true href=#concluding-benchmarks>#</a></h2><p>From custom benchmarks, we can say that for normal requests Dart backends are comparable to other Languages but they are pretty slow when it comes to multipart files or if we want to send huge JSON data (which is very less likely) but we know that Dart&rsquo;s native JSON parsers are pretty slow.</p><p>Though there are a few packages that are faster than the native parser like <a href=https://pub.dev/packages/crimson>crimson</a>.</p><p>Multipart files are slow as of now but I&rsquo;m pretty optimistic about it as well.</p><h1 id=features-and-code-snippets>Features and code snippets<a hidden class=anchor aria-hidden=true href=#features-and-code-snippets>#</a></h1><h3 id=conduit-dart-1>Conduit (Dart)<a hidden class=anchor aria-hidden=true href=#conduit-dart-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>class</span> <span class=nc>DartConduitChannel</span> <span class=kd>extends</span> <span class=n>ApplicationChannel</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=n>Controller</span> <span class=kd>get</span> <span class=n>entryPoint</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>router</span> <span class=o>=</span> <span class=n>Router</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>router</span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s2>&#34;/echo&#34;</span><span class=p>).</span><span class=n>linkFunction</span><span class=p>((</span><span class=n>request</span><span class=p>)</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=n>method</span> <span class=o>==</span> <span class=s2>&#34;POST&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>final</span> <span class=n>body</span> <span class=o>=</span> <span class=kd>await</span> <span class=n>request</span><span class=p>.</span><span class=n>body</span><span class=p>.</span><span class=n>decode</span><span class=o>&lt;</span><span class=n>Map</span><span class=o>&lt;</span><span class=kt>String</span><span class=p>,</span> <span class=kt>dynamic</span><span class=o>&gt;&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Response</span><span class=p>.</span><span class=n>ok</span><span class=p>({</span><span class=s2>&#34;response&#34;</span><span class=o>:</span> <span class=s2>&#34;Hello, </span><span class=si>${</span><span class=n>body</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span><span class=si>}</span><span class=s2>!&#34;</span><span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>Response</span><span class=p>.</span><span class=n>notFound</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>router</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Conduit is a successor of <a href=https://aqueduct.io/>Aqueduct</a> (another dart framework). You can create Controllers to handle each path and can link/chain them to apply rules (eg. authentication/authorization).</p><p>It has an inbuilt ORM and OAuth 2.0 security models.</p><p>The thing that I don&rsquo;t like about it is that it lacks documentation and it&rsquo;s too verbose.</p><h3 id=dia-dart-1>Dia (Dart)<a hidden class=anchor aria-hidden=true href=#dia-dart-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kt>void</span> <span class=n>main</span><span class=p>(</span><span class=n>List</span><span class=o>&lt;</span><span class=kt>String</span><span class=o>&gt;</span> <span class=n>args</span><span class=p>)</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>app</span> <span class=o>=</span> <span class=n>App</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>router</span> <span class=o>=</span> <span class=n>Router</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>router</span><span class=p>.</span><span class=n>post</span><span class=p>(</span><span class=s1>&#39;/echo&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>next</span><span class=p>)</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>map</span> <span class=o>=</span> <span class=n>ctx</span><span class=p>.</span><span class=n>parsed</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ctx</span><span class=p>.</span><span class=n>body</span> <span class=o>=</span> <span class=n>json</span><span class=p>.</span><span class=n>encode</span><span class=p>({</span><span class=s2>&#34;response&#34;</span><span class=o>:</span> <span class=s2>&#34;Hello, </span><span class=si>${</span><span class=n>map</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span><span class=si>}</span><span class=s2>!&#34;</span><span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>app</span><span class=p>.</span><span class=n>use</span><span class=p>(</span><span class=n>body</span><span class=p>());</span>
</span></span><span class=line><span class=cl>  <span class=n>app</span><span class=p>.</span><span class=n>use</span><span class=p>(</span><span class=n>router</span><span class=p>.</span><span class=n>middleware</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>app</span><span class=p>.</span><span class=n>listen</span><span class=p>(</span><span class=s2>&#34;127.0.0.1&#34;</span><span class=p>,</span> <span class=m>8080</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Dia is a simple framework with APIs similar to Express.</p><p>It has separate packages for <a href=https://pub.dev/packages/dia_body>body parsing</a>, <a href=https://pub.dev/packages/dia_cors>CORS middleware</a>, <a href=https://pub.dev/packages/dia_router>router</a> and <a href=https://pub.dev/packages/dia_static>static server</a>.</p><p>Shoutout to <a href=https://github.com/unger1984>Andrey Unger</a> for contributing to the repository.</p><h3 id=dart_frog-dart-1>dart_frog (Dart)<a hidden class=anchor aria-hidden=true href=#dart_frog-dart-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>Future</span><span class=o>&lt;</span><span class=n>Response</span><span class=o>&gt;</span> <span class=n>onRequest</span><span class=p>(</span><span class=n>RequestContext</span> <span class=n>context</span><span class=p>)</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>context</span><span class=p>.</span><span class=n>request</span><span class=p>.</span><span class=n>method</span><span class=o>==</span> <span class=n>HttpMethod</span><span class=p>.</span><span class=n>post</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>body</span> <span class=o>=</span> <span class=kd>await</span> <span class=n>context</span><span class=p>.</span> <span class=n>request</span><span class=p>.</span><span class=n>json</span><span class=p>()</span> <span class=o>as</span> <span class=n>Map</span><span class=o>&lt;</span><span class=kt>String</span><span class=p>,</span> <span class=kt>dynamic</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Response</span><span class=p>.</span><span class=n>json</span><span class=p>(</span><span class=nl>body:</span> <span class=p>{</span><span class=nl>response:</span> <span class=s2>&#34;Hello, </span><span class=si>${</span><span class=n>body</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span><span class=si>}</span><span class=s2>!&#34;</span><span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>Response</span><span class=p>(</span> <span class=nl>statusCode:</span> <span class=n>HttpStatus</span><span class=p>.</span><span class=n>notFound</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>dart_frog is one of my favorite frameworks in terms of API design as it supports file-based routing. So you can make files and directories instead of writing routes manually. It would be great if we could avoid writing if/else statements to check the kind of requests.</p><p>Under the hood it generates <code>shelf</code> code so you can use <em>almost</em> all the packages made for shelf.</p><p>Now it also supports multipart form requests which lacking when I was writing the previous blog.</p><h3 id=minerva-dart-1>minerva (Dart)<a hidden class=anchor aria-hidden=true href=#minerva-dart-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>class</span> <span class=nc>EndpointsBuilder</span> <span class=kd>extends</span> <span class=n>MinervaEndpointsBuilder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=kt>void</span> <span class=n>build</span><span class=p>(</span><span class=n>Endpoints</span> <span class=n>endpoints</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>endpoints</span><span class=p>.</span><span class=n>post</span><span class=p>(</span><span class=s1>&#39;/echo&#39;</span><span class=p>,</span> <span class=n>_echo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>dynamic</span> <span class=n>_echo</span><span class=p>(</span><span class=n>ServerContext</span> <span class=n>context</span><span class=p>,</span> <span class=n>MinervaRequest</span> <span class=n>request</span><span class=p>)</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=n>json</span> <span class=o>=</span> <span class=kd>await</span> <span class=n>request</span><span class=p>.</span><span class=n>body</span><span class=p>.</span><span class=n>asJson</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;response&#34;</span><span class=o>:</span> <span class=s2>&#34;Hello, </span><span class=si>${</span><span class=n>json</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>!&#34;</span><span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Minvera sits kinda in the middle of easy and complex enough. I haven&rsquo;t worked with it a lot but from the docs, I can say that it has all the things you might need. I would love to see if the APIs could be simplified more without <a href=https://pub.dev/packages/minerva_controller_generator>minerva_controller_generator</a>.</p><p>The developer also maintains packages that could be used outside of minerva like <a href=https://pub.dev/packages/emerald>emerald</a> for JSON parsing, <a href=https://pub.dev/packages/mcache>mcache</a> for caching values.</p><p>It performed well in <a href=#minerva-dart>load testing</a> because of how it is built, so if the load increases it might increase server instances.</p><p><img alt="Minerva&rsquo;s framework" loading=lazy src=https://raw.githubusercontent.com/GlebBatykov/minerva/main/doc/images/server_structure.png></p><p>You can read more about the framework design from the <a href=https://pub.dev/packages/minerva#framework-structure>documentation</a>.</p><p>Shoutout to <a href=https://github.com/GlebBatykov>Gleb Batykov</a> for contributing to the repository.</p><h3 id=shelf-dart-1>shelf (Dart)<a hidden class=anchor aria-hidden=true href=#shelf-dart-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kd>final</span> <span class=n>_router</span> <span class=o>=</span> <span class=n>Router</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>..</span><span class=n>post</span><span class=p>(</span><span class=s1>&#39;/echo&#39;</span><span class=p>,</span> <span class=n>_echoHandler</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Future</span><span class=o>&lt;</span><span class=n>Response</span><span class=o>&gt;</span> <span class=n>_echoHandler</span><span class=p>(</span><span class=n>Request</span> <span class=n>request</span><span class=p>)</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>string</span> <span class=o>=</span> <span class=kd>await</span> <span class=n>request</span><span class=p>.</span><span class=n>readAsString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>body</span> <span class=o>=</span> <span class=n>json</span><span class=p>.</span><span class=n>decode</span><span class=p>(</span><span class=n>string</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>Response</span><span class=p>.</span><span class=n>ok</span><span class=p>(</span><span class=n>json</span><span class=p>.</span><span class=n>encode</span><span class=p>({</span><span class=s2>&#34;response&#34;</span><span class=o>:</span> <span class=s2>&#34;Hello, </span><span class=si>${</span><span class=n>body</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span><span class=si>}</span><span class=s2>!&#34;</span><span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>main</span><span class=p>(</span><span class=n>List</span><span class=o>&lt;</span><span class=kt>String</span><span class=o>&gt;</span> <span class=n>args</span><span class=p>)</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>ip</span> <span class=o>=</span> <span class=n>InternetAddress</span><span class=p>(</span><span class=s2>&#34;127.0.0.1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>handler</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>().</span><span class=n>addHandler</span><span class=p>(</span><span class=n>_router</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>port</span> <span class=o>=</span> <span class=kt>int</span><span class=p>.</span><span class=n>parse</span><span class=p>(</span><span class=n>Platform</span><span class=p>.</span><span class=n>environment</span><span class=p>[</span><span class=s1>&#39;PORT&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;8080&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>server</span> <span class=o>=</span> <span class=kd>await</span> <span class=n>serve</span><span class=p>(</span><span class=n>handler</span><span class=p>,</span> <span class=n>ip</span><span class=p>,</span> <span class=n>port</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Shelf is developed and maintained by the Dart team. It is very barebones and asks you to do a lot of stuff on your own.</p><p>It has packages for <a href=https://pub.dev/packages/shelf_router>routing</a>, <a href=https://pub.dev/packages/shelf_multipart>handling form data(3rd party)</a> and a lot <a href="https://pub.dev/packages?q=shelf">more</a> developed by the Dart team and individual developers.</p><h3 id=spry-dart-1>spry (Dart)<a hidden class=anchor aria-hidden=true href=#spry-dart-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kt>void</span> <span class=n>main</span><span class=p>(</span><span class=n>List</span><span class=o>&lt;</span><span class=kt>String</span><span class=o>&gt;</span> <span class=n>arguments</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>spry</span> <span class=o>=</span> <span class=n>Spry</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>router</span> <span class=o>=</span> <span class=n>Router</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>router</span><span class=p>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&#34;/echo&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>context</span><span class=p>)</span> <span class=kd>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>final</span> <span class=n>name</span> <span class=o>=</span> <span class=p>(</span><span class=kd>await</span> <span class=n>context</span><span class=p>.</span><span class=n>request</span><span class=p>.</span><span class=n>json</span><span class=p>)[</span><span class=s2>&#34;name&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>context</span><span class=p>.</span><span class=n>response</span><span class=p>.</span><span class=n>json</span><span class=p>({</span><span class=s2>&#34;message&#34;</span><span class=o>:</span> <span class=s2>&#34;Hello </span><span class=si>$</span><span class=n>name</span><span class=s2>!&#34;</span><span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>spry</span><span class=p>.</span><span class=n>listen</span><span class=p>(</span><span class=n>router</span><span class=p>,</span> <span class=nl>port:</span> <span class=m>8080</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Spry is another one of my favorite frameworks not only because it has a cute name but also because it is very flexible. If you like to define routes you can use their <a href=https://pub.dev/packages/spry_router>spry_router</a> package or if you are like me and loves file-based routing you can have <a href=https://pub.dev/packages/spry_fsrouter>spry_fsrouter</a> and which has a lot of <a href="https://pub.dev/packages?q=publisher%3Aodroe.com+spry">first-party packages</a>.</p><h3 id=expressjs-node-1>expressjs (Node)<a hidden class=anchor aria-hidden=true href=#expressjs-node-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;express&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>expressFileUpload</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;express-fileupload&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>bodyParser</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;body-parser&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>bodyParser</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> <span class=nx>limit</span><span class=o>:</span> <span class=s2>&#34;50mb&#34;</span><span class=p>,</span> <span class=nx>strict</span><span class=o>:</span> <span class=kc>false</span> <span class=p>}));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s2>&#34;/echo&#34;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>response</span><span class=o>:</span> <span class=sb>`Hello, </span><span class=si>${</span><span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb>!`</span> <span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>8080</span><span class=p>,</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>);</span>
</span></span></code></pre></div><p>It is the most famous framework for writing servers in JS/TS and has been there for a long time.</p><h3 id=flask-python-1>Flask (Python)<a hidden class=anchor aria-hidden=true href=#flask-python-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/echo&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>echo</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;response&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Hello, </span><span class=si>{</span><span class=n>body</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>!&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></div><p>It is a very simple and easy-to-use Python framework. If you like it then I would also suggest you try <a href=https://fastapi.tiangolo.com/>FastAPI</a>.</p><h3 id=fiber-go-1>Fiber (Go)<a hidden class=anchor aria-hidden=true href=#fiber-go-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>app</span> <span class=o>:=</span> <span class=nx>fiber</span><span class=p>.</span><span class=nf>New</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>app</span><span class=p>.</span><span class=nf>Post</span><span class=p>(</span><span class=s>&#34;/echo&#34;</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>c</span> <span class=o>*</span><span class=nx>fiber</span><span class=p>.</span><span class=nx>Ctx</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kd>type</span> <span class=nx>User</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=nx>user</span> <span class=o>:=</span> <span class=nb>new</span><span class=p>(</span><span class=nx>User</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>c</span><span class=p>.</span><span class=nf>BodyParser</span><span class=p>(</span><span class=nx>user</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>c</span><span class=p>.</span><span class=nf>JSON</span><span class=p>(</span><span class=nx>fiber</span><span class=p>.</span><span class=nx>Map</span><span class=p>{</span><span class=s>&#34;response&#34;</span><span class=p>:</span> <span class=s>&#34;Hello, &#34;</span> <span class=o>+</span> <span class=nx>user</span><span class=p>.</span><span class=nx>Name</span> <span class=o>+</span> <span class=s>&#34;!&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>app</span><span class=p>.</span><span class=nf>Listen</span><span class=p>(</span><span class=s>&#34;:8080&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Fiber is the fastest framework in the results of our benchmark which was kind of expected as it is written in Golang. But go is not a language that everyone uses and it&rsquo;s a bit difficult to start with as it&rsquo;s a very minimal language. If you like minimal languages then Go is your perfect partner.</p><h2 id=concluding-features-and-code>Concluding features and code<a hidden class=anchor aria-hidden=true href=#concluding-features-and-code>#</a></h2><p>Coding style depends on person to person you might like something which I might not, look at the basic snippets and choose what you like because most of the features basic will be available for all the frameworks and you can always implement your own thing as you go.</p><p>I&rsquo;m also interested in <a href=https://serverpod.dev>Serverpod</a>, it brings in a lot of features and it&rsquo;s also an end-to-end solution for building a Dart server and Flutter app. Not touching it right now as it looks a bit complicated ðŸ˜…</p><h1 id=infrastructure-support>Infrastructure Support<a hidden class=anchor aria-hidden=true href=#infrastructure-support>#</a></h1><p>A lot of platforms support Dart deployment such as -</p><ul><li><a href=https://cloud.google.com/run/>Google Cloud Run</a></li><li><a href=https://aws.amazon.com/lambda/>AWS Lambda</a></li><li><a href=https://appwrite.io/docs/functions>Appwrite</a></li><li><a href=https://docs.digitalocean.com/products/app-platform/>DigitalOcean App Platform</a></li></ul><h2 id=dart-edge>Dart Edge<a hidden class=anchor aria-hidden=true href=#dart-edge>#</a></h2><p><a href=https://docs.dartedge.dev/>Dart Edge</a> is a project by <a href=https://invertase.io/>Invertase</a> to run Dart on Edge function by transpiling it to JS (or WASM soon).</p><p>Currently, it only supports <a href=https://workers.cloudflare.com/>Cloudflare Workers</a>, and <a href=https://vercel.com/features/edge-functions>Vercel Edge Functions</a> and plans to support more in the future.</p><h1 id=final-thoughts>Final thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h1><p>Right now I feel Dart backends are going in the right direction and it would be a good time to start learning. Still wouldn&rsquo;t suggest building your billion-dollar company (maybe in a few years ðŸ¤ž) on it as it would be difficult to find a developer who would love to write Dart backend or <a href=mailto:hey@darshanrander.com>hire me</a>.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://blog.darshanrander.com/posts/diary/the-real-truth/><span class=title>Â« Prev</span><br><span>The Real Truth</span>
</a><a class=next href=https://blog.darshanrander.com/posts/diary/expectation-never-kills/><span class=title>Next Â»</span><br><span>Expectation never kills.</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Serverside Dart #2 on x" href="https://x.com/intent/tweet/?text=Serverside%20Dart%20%232&amp;url=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fserverside-dart-2%2f&amp;hashtags=Server%2cBackend%2cDart%2cBenchmark%2cTech"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Serverside Dart #2 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fserverside-dart-2%2f&amp;title=Serverside%20Dart%20%232&amp;summary=Serverside%20Dart%20%232&amp;source=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fserverside-dart-2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Serverside Dart #2 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fserverside-dart-2%2f&title=Serverside%20Dart%20%232"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Serverside Dart #2 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fserverside-dart-2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Serverside Dart #2 on whatsapp" href="https://api.whatsapp.com/send?text=Serverside%20Dart%20%232%20-%20https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fserverside-dart-2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Serverside Dart #2 on telegram" href="https://telegram.me/share/url?text=Serverside%20Dart%20%232&amp;url=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fserverside-dart-2%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Serverside Dart #2 on ycombinator" href="https://news.ycombinator.com/submitlink?t=Serverside%20Dart%20%232&u=https%3a%2f%2fblog.darshanrander.com%2fposts%2ftech%2fserverside-dart-2%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>Â© 2022 <a href=https://darshanrander.com>Darshan Rander</a> |</span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>